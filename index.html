<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
  <meta http-equiv="Content-Style-Type" content="text/css">
  <title></title>
  <meta name="Generator" content="Cocoa HTML Writer">
  <meta name="CocoaVersion" content="2575.7">
  <style type="text/css">
    body {background-color: #eff2f7}
    p.p1 {margin: 0.0px 0.0px 0.0px 0.0px; font: 14.0px Menlo; color: #202126; -webkit-text-stroke: #202126; background-color: #ffffff}
    p.p2 {margin: 0.0px 0.0px 0.0px 0.0px; font: 14.0px Menlo; color: #202126; -webkit-text-stroke: #202126; background-color: #ffffff; min-height: 16.0px}
    span.s1 {font-kerning: none}
  </style>
</head>
<body>
<p class="p1"><span class="s1">&lt;!DOCTYPE html&gt;</span></p>
<p class="p1"><span class="s1">&lt;html lang="nl"&gt;</span></p>
<p class="p1"><span class="s1">&lt;head&gt;</span></p>
<p class="p1"><span class="s1">&lt;meta charset="utf-8"&gt;</span></p>
<p class="p1"><span class="s1">&lt;title&gt;VloerenOffertePro&lt;/title&gt;</span></p>
<p class="p1"><span class="s1">&lt;meta name="viewport" content="width=device-width, initial-scale=1"&gt;</span></p>
<p class="p1"><span class="s1">&lt;style&gt;</span></p>
<p class="p1"><span class="s1">:root{--primary:#0d47a1;--secondary:#ff6f00;--ok:#2e7d32;--danger:#c62828;--bg:#f5f7fa;--card:#fff;--text:#212121;--mute:#757575;--radius:6px;}</span></p>
<p class="p1"><span class="s1">*{box-sizing:border-box;font-family:'Segoe UI',Roboto,Helvetica,Arial,sans-serif;}</span></p>
<p class="p1"><span class="s1">body{margin:0;background:var(--bg);color:var(--text);}</span></p>
<p class="p1"><span class="s1">h1,h2,h3{margin:0 0 .5em;font-weight:600;}</span></p>
<p class="p1"><span class="s1">.tabs{display:flex;border-bottom:2px solid var(--primary);}</span></p>
<p class="p1"><span class="s1">.tabs button{flex:1;padding:12px;font-size:16px;border:none;background:#fff;cursor:pointer;transition:.2s;color:var(--primary);}</span></p>
<p class="p1"><span class="s1">.tabs button.active{background:var(--primary);color:#fff;}</span></p>
<p class="p1"><span class="s1">.tab-content{display:none;padding:20px;}</span></p>
<p class="p1"><span class="s1">.tab-content.active{display:block;}</span></p>
<p class="p1"><span class="s1">.row{display:flex;gap:20px;margin-bottom:20px;flex-wrap:wrap;}</span></p>
<p class="p1"><span class="s1">.col{flex:1;min-width:280px;background:var(--card);padding:18px;border-radius:var(--radius);box-shadow:0 1px 3px rgba(0,0,0,.08);}</span></p>
<p class="p1"><span class="s1">label{display:block;margin:.5em 0 .2em;font-weight:600;font-size:14px;}</span></p>
<p class="p1"><span class="s1">input,select,textarea{width:100%;padding:8px 10px;border:1px solid #bbb;border-radius:var(--radius);}</span></p>
<p class="p1"><span class="s1">input[type=checkbox]{width:auto;margin-right:6px;}</span></p>
<p class="p1"><span class="s1">.btn{padding:10px 18px;border:none;border-radius:var(--radius);cursor:pointer;font-size:15px;background:var(--primary);color:#fff;margin-top:10px;margin-right:8px;}</span></p>
<p class="p1"><span class="s1">.btn.secondary{background:var(--secondary);}</span></p>
<p class="p1"><span class="s1">.btn.danger{background:var(--danger);}</span></p>
<p class="p1"><span class="s1">.btn.success{background:var(--ok);}</span></p>
<p class="p1"><span class="s1">.kpi{background:var(--primary);color:#fff;padding:20px;border-radius:var(--radius);text-align:center;font-size:26px;font-weight:700;margin-bottom:20px;}</span></p>
<p class="p1"><span class="s1">table{width:100%;border-collapse:collapse;font-size:14px;}</span></p>
<p class="p1"><span class="s1">th,td{padding:8px 10px;text-align:left;border-bottom:1px solid #e0e0e0;}</span></p>
<p class="p1"><span class="s1">th{background:#fafafa;}</span></p>
<p class="p1"><span class="s1">.preview-img{max-width:100%;max-height:220px;border-radius:var(--radius);}</span></p>
<p class="p1"><span class="s1">canvas{max-width:100%;}</span></p>
<p class="p1"><span class="s1">@media screen {.print-header{display:none;}}</span></p>
<p class="p1"><span class="s1">@media print{</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>body{background:#fff;color:#000;margin:0;}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>.tabs,.btn{display:none !important;}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>.print-header{display:flex;align-items:center;justify-content:space-between;margin-bottom:20px;border-bottom:2px solid var(--primary);padding-bottom:10px;}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>.print-header img{height:60px;}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>.print-header .co-info{text-align:right;font-size:13px;line-height:1.4;}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>.row{page-break-inside:avoid;}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>table.details th.nr,table.details td.nr{text-align:right;}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">  </span>table.details tr.tot{background:#f5f5f5;font-weight:700;}</span></p>
<p class="p1"><span class="s1">}</span></p>
<p class="p1"><span class="s1">.material-row{display:grid;grid-template-columns:1fr 1fr 1fr 1fr 1fr 1fr auto;gap:8px;margin-bottom:8px;align-items:center;}</span></p>
<p class="p1"><span class="s1">.material-row input,.material-row select{padding:6px;font-size:13px;}</span></p>
<p class="p1"><span class="s1">&lt;/style&gt;</span></p>
<p class="p1"><span class="s1">&lt;/head&gt;</span></p>
<p class="p1"><span class="s1">&lt;body&gt;</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">&lt;div class="tabs"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>&lt;button class="active" onclick="switchTab(event,'calc')"&gt;Calculatie&lt;/button&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>&lt;button onclick="switchTab(event,'quote')"&gt;Offerte&lt;/button&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>&lt;button onclick="switchTab(event,'mgmt')"&gt;Management&lt;/button&gt;</span></p>
<p class="p1"><span class="s1">&lt;/div&gt;</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">&lt;!-- ========================== CALCULATIE ========================== --&gt;</span></p>
<p class="p1"><span class="s1">&lt;div id="calc" class="tab-content active"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>&lt;h1&gt;1. Project &amp;amp; Klantgegevens&lt;/h1&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>&lt;div class="row"&gt;&lt;div class="col"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>&lt;label&gt;Projectnaam *&lt;/label&gt;&lt;input id="projName" placeholder="Woonkamer Familie De Vries"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>&lt;label&gt;Klantnaam&lt;/label&gt;&lt;input id="custName" placeholder="Zoek of typ"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>&lt;label&gt;Projectadres *&lt;/label&gt;&lt;input id="projAdres" placeholder="Straat 1, 1234 AB Stad"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>&lt;label&gt;Status&lt;/label&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>&lt;select id="status"&gt;&lt;option&gt;Concept&lt;/option&gt;&lt;option&gt;Verzonden&lt;/option&gt;&lt;option&gt;Aangepast&lt;/option&gt;&lt;option&gt;Gewonnen&lt;/option&gt;&lt;option&gt;Verloren&lt;/option&gt;&lt;/select&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>&lt;/div&gt;&lt;/div&gt;</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>&lt;h1&gt;2. Vloerkeuze &amp;amp; Hoeveelheden&lt;/h1&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>&lt;div class="row"&gt;&lt;div class="col"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>&lt;label&gt;Vloeroppervlakte (m²) *&lt;/label&gt;&lt;input id="vlOppervl" type="number" step="0.1" oninput="bereken()"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>&lt;label&gt;Vloertype *&lt;/label&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>&lt;select id="vlType" oninput="bereken()"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>&lt;option value=""&gt;Kies…&lt;/option&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>&lt;option&gt;PVC&lt;/option&gt;&lt;option&gt;Laminaat&lt;/option&gt;&lt;option&gt;Hout&lt;/option&gt;&lt;option&gt;Gietvloer&lt;/option&gt;&lt;option&gt;Tegels&lt;/option&gt;&lt;option&gt;Vloerbedekking&lt;/option&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>&lt;/select&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>&lt;label&gt;Product (Merk / Kleur)&lt;/label&gt;&lt;input id="vlProd" placeholder="Quick-Step Classic – Eik Wit"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>&lt;label&gt;Afwerking&lt;/label&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>&lt;select id="afwerk"&gt;&lt;option&gt;Mat&lt;/option&gt;&lt;option&gt;Zijdeglans&lt;/option&gt;&lt;option&gt;Structuur&lt;/option&gt;&lt;/select&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>&lt;label&gt;Zaagverlies (%)&lt;/label&gt;&lt;input id="zaagV" type="number" step="0.1" value="5" oninput="bereken()"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>&lt;label&gt;Netto vloerprijs (€/m² excl.)&lt;/label&gt;&lt;input id="vlPrijs" type="number" step="0.01" oninput="bereken()"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>&lt;label&gt;Totaal m² vloer (incl. zaagverlies)&lt;/label&gt;&lt;input id="vlTotaal" readonly&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>&lt;/div&gt;&lt;/div&gt;</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>&lt;h1&gt;3. Ondervloer, Plinten &amp;amp; Toebehoren&lt;/h1&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>&lt;div class="row"&gt;&lt;div class="col"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>&lt;label&gt;&lt;input id="ondVereist" type="checkbox" oninput="bereken()"&gt; Ondervloer vereist?&lt;/label&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>&lt;label&gt;Ondervloer selectie&lt;/label&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>&lt;select id="ondKeuze" oninput="bereken()"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>&lt;option value=""&gt;Kies…&lt;/option&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>&lt;option&gt;Beton&lt;/option&gt;&lt;option&gt;Hout&lt;/option&gt;&lt;option&gt;Polystyreen&lt;/option&gt;&lt;option&gt;Anders&lt;/option&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>&lt;/select&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>&lt;label&gt;Ondervloer prijs (€/m²)&lt;/label&gt;&lt;input id="ondPrijs" type="number" step="0.01" oninput="bereken()"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>&lt;label&gt;Plint omtrek (m)&lt;/label&gt;&lt;input id="omtrek" type="number" step="0.1" oninput="bereken()"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>&lt;label&gt;Plint selectie&lt;/label&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>&lt;select id="plintKeuze" oninput="bereken()"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>&lt;option value=""&gt;Kies…&lt;/option&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>&lt;option&gt;Eiken&lt;/option&gt;&lt;option&gt;Duifenkast&lt;/option&gt;&lt;option&gt;Geen&lt;/option&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>&lt;/select&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>&lt;label&gt;Plint prijs (€/m)&lt;/label&gt;&lt;input id="plintPrijs" type="number" step="0.01" oninput="bereken()"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>&lt;/div&gt;&lt;/div&gt;</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>&lt;h1&gt;4. Overige materialen (meerdere regels)&lt;/h1&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>&lt;div class="row"&gt;&lt;div class="col"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>&lt;div id="materialContainer"&gt;&lt;/div&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>&lt;button type="button" class="btn secondary" onclick="addMaterialRow()"&gt;+ Regel toevoegen&lt;/button&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>&lt;/div&gt;&lt;/div&gt;</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>&lt;h1&gt;5. Arbeid &amp;amp; Service&lt;/h1&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>&lt;div class="row"&gt;&lt;div class="col"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>&lt;label&gt;Leggen vloer (€/m²)&lt;/label&gt;&lt;input id="leggen" type="number" step="0.01" oninput="bereken()"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>&lt;label&gt;Leggen toeslag (€/m² of %)&lt;/label&gt;&lt;input id="legToeslag" type="number" step="0.01" placeholder="0" oninput="bereken()"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>&lt;label&gt;Egaliseren (€/m²)&lt;/label&gt;&lt;input id="egal" type="number" step="0.01" oninput="bereken()"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>&lt;label&gt;Oude vloer verwijderen (€/m²)&lt;/label&gt;&lt;input id="oudVloer" type="number" step="0.01" oninput="bereken()"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>&lt;label&gt;Voorrijkosten / transport €&lt;/label&gt;&lt;input id="vrijKosten" type="number" step="0.01" oninput="bereken()"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>&lt;label&gt;Vrij tekst (condities)&lt;/label&gt;&lt;textarea id="vrijTekst" rows="3" placeholder="Niet inbegrepen: verwijdering meubels..."&gt;&lt;/textarea&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>&lt;/div&gt;&lt;/div&gt;</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>&lt;h1&gt;6. Finale Prijscalculatie&lt;/h1&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>&lt;div class="row"&gt;&lt;div class="col"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>&lt;table&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>&lt;tr&gt;&lt;th&gt;Post&lt;/th&gt;&lt;th&gt;Bedrag (€ excl.)&lt;/th&gt;&lt;/tr&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>&lt;tr&gt;&lt;td&gt;Subtotaal Materialen&lt;/td&gt;&lt;td id="subMat"&gt;0.00&lt;/td&gt;&lt;/tr&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>&lt;tr&gt;&lt;td&gt;Subtotaal Arbeid&lt;/td&gt;&lt;td id="subArb"&gt;0.00&lt;/td&gt;&lt;/tr&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>&lt;tr&gt;&lt;td&gt;Totaal Netto&lt;/td&gt;&lt;td id="totNetto"&gt;0.00&lt;/td&gt;&lt;/tr&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>&lt;tr&gt;&lt;td&gt;BTW 21%&lt;/td&gt;&lt;td id="btw"&gt;0.00&lt;/td&gt;&lt;/tr&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>&lt;tr&gt;&lt;td&gt;&lt;strong&gt;Totaal Offerteprijs (Bruto)&lt;/strong&gt;&lt;/td&gt;&lt;td id="totBruto"&gt;&lt;strong&gt;0.00&lt;/strong&gt;&lt;/td&gt;&lt;/tr&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>&lt;/table&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>&lt;button class="btn success" onclick="saveCalc()"&gt;Opslaan &amp;amp; Offerte Tonen&lt;/button&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>&lt;button type="button" class="btn danger" onclick="resetForm()"&gt;🗑 Nieuw formulier&lt;/button&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>&lt;button type="button" class="btn secondary" onclick="exportCSV()"&gt;Export CSV&lt;/button&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>&lt;/div&gt;&lt;/div&gt;</span></p>
<p class="p1"><span class="s1">&lt;/div&gt;</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">&lt;!-- ========================== OFFERTES ========================== --&gt;</span></p>
<p class="p1"><span class="s1">&lt;div id="quote" class="tab-content"&gt;&lt;div id="quotePreview"&gt;&lt;/div&gt;&lt;/div&gt;</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">&lt;!-- ========================== MANAGEMENT ======================= --&gt;</span></p>
<p class="p1"><span class="s1">&lt;div id="mgmt" class="tab-content"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>&lt;h1&gt;Management Dashboard&lt;/h1&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>&lt;div class="row"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>&lt;div class="col"&gt;&lt;div class="kpi" id="kpiAOV"&gt;Gem. Orderwaarde&lt;br/&gt;€ &lt;span&gt;0&lt;/span&gt;&lt;/div&gt;&lt;/div&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>&lt;div class="col"&gt;&lt;div class="kpi" id="kpiConv"&gt;Conversie&lt;br/&gt;&lt;span&gt;0&lt;/span&gt; %&lt;/div&gt;&lt;/div&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>&lt;div class="col"&gt;&lt;div class="kpi" id="kpiPipe"&gt;Pipeline&lt;br/&gt;€ &lt;span&gt;0&lt;/span&gt;&lt;/div&gt;&lt;/div&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>&lt;/div&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>&lt;h2&gt;Offerte‑Pijplijn&lt;/h2&gt;&lt;canvas id="pipeChart" height="120"&gt;&lt;/canvas&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>&lt;h2&gt;Redenen Verloren&lt;/h2&gt;&lt;canvas id="lossChart" height="120"&gt;&lt;/canvas&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>&lt;h2&gt;Performance per Productgroep&lt;/h2&gt;&lt;canvas id="prodChart" height="120"&gt;&lt;/canvas&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>&lt;button class="btn" onclick="resetData()"&gt;Reset demo data&lt;/button&gt;</span></p>
<p class="p1"><span class="s1">&lt;/div&gt;</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">&lt;script&gt;</span></p>
<p class="p1"><span class="s1">/* ---------- GLOBAL STORE ---------- */</span></p>
<p class="p1"><span class="s1">const STORE = {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>getCalc() <span class="Apple-converted-space">  </span>{ return JSON.parse(localStorage.getItem('calc') || '{}'); },</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>setCalc(o)<span class="Apple-converted-space">  </span>{ localStorage.setItem('calc', JSON.stringify(o)); },</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>getOffertes(){ return JSON.parse(localStorage.getItem('offertes') || '[]'); },</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>setOffertes(arr){ localStorage.setItem('offertes', JSON.stringify(arr)); },</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>addOfferte(o){</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>const arr = this.getOffertes();</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>o.id = Date.now();</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>arr.push(o);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>this.setOffertes(arr);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>}</span></p>
<p class="p1"><span class="s1">};</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">/* ---------- TABS ---------- */</span></p>
<p class="p1"><span class="s1">function switchTab(ev, id){</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>document.querySelectorAll('.tab-content').forEach(t=&gt;t.classList.remove('active'));</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>document.querySelectorAll('.tabs button').forEach(b=&gt;b.classList.remove('active'));</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>document.getElementById(id).classList.add('active');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>if (ev &amp;&amp; ev.target) ev.target.classList.add('active');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>if (id === 'quote') renderQuote();</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>if (id === 'mgmt') renderMgmt();</span></p>
<p class="p1"><span class="s1">}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">/* ---------- CALCULATE ---------- */</span></p>
<p class="p1"><span class="s1">function bereken(){</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>const vl <span class="Apple-converted-space">  </span>= parseFloat(document.getElementById('vlOppervl').value) || 0;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>const zv <span class="Apple-converted-space">  </span>= parseFloat(document.getElementById('zaagV').value) || 0;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>const vlTotaal = vl * (1 + zv/100);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>document.getElementById('vlTotaal').value = vlTotaal.toFixed(2);</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>const vlPrijs <span class="Apple-converted-space">  </span>= parseFloat(document.getElementById('vlPrijs').value) || 0;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>const ondPrijs<span class="Apple-converted-space">  </span>= (document.getElementById('ondVereist').checked) ?</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                     </span>(parseFloat(document.getElementById('ondPrijs').value) || 0) : 0;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>const omtrek<span class="Apple-converted-space">    </span>= parseFloat(document.getElementById('omtrek').value) || 0;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>const plintPrijs = parseFloat(document.getElementById('plintPrijs').value) || 0;</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>const materialTotal = getMaterialTotal();</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>const subMat = (vlTotaal * vlPrijs) + (vl * ondPrijs) + (omtrek * plintPrijs) + materialTotal;</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>const leggen <span class="Apple-converted-space">  </span>= parseFloat(document.getElementById('leggen').value) || 0;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>const toeslag<span class="Apple-converted-space">  </span>= parseFloat(document.getElementById('legToeslag').value) || 0;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>const egal <span class="Apple-converted-space">    </span>= parseFloat(document.getElementById('egal').value) || 0;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>const oud<span class="Apple-converted-space">      </span>= parseFloat(document.getElementById('oudVloer').value) || 0;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>const vrij <span class="Apple-converted-space">    </span>= parseFloat(document.getElementById('vrijKosten').value) || 0;</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>const subArb = (vl * leggen) + (vl * toeslag) + (vl * egal) + (vl * oud) + vrij;</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>const netto = subMat + subArb;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>const btw <span class="Apple-converted-space">  </span>= netto * 0.21;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>const bruto = netto + btw;</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>document.getElementById('subMat').innerText <span class="Apple-converted-space">  </span>= subMat.toFixed(2);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>document.getElementById('subArb').innerText <span class="Apple-converted-space">  </span>= subArb.toFixed(2);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>document.getElementById('totNetto').innerText = netto.toFixed(2);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>document.getElementById('btw').innerText<span class="Apple-converted-space">      </span>= btw.toFixed(2);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>document.getElementById('totBruto').innerText = bruto.toFixed(2);</span></p>
<p class="p1"><span class="s1">}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">/* ---------- MATERIAL LOGIC ---------- */</span></p>
<p class="p1"><span class="s1">const materialOptions = ['Lijm','Egalisatie','Primer','Voegkitt','Schuurpapier','Anders'];</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">function addMaterialRow(data = {}){</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>const container = document.getElementById('materialContainer');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>const row = document.createElement('div');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>row.className = 'material-row';</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>row.innerHTML = `</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>&lt;select class="matType"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>&lt;option value=""&gt;Kies…&lt;/option&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>${materialOptions.map(o =&gt; `&lt;option value="${o}" ${data.type===o?'selected':''}&gt;${o}&lt;/option&gt;`).join('')}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>&lt;/select&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>&lt;input type="text" <span class="Apple-converted-space">  </span>class="matLeverancier" placeholder="Leverancier" value="${data.leverancier||''}"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>&lt;input type="number" class="matAantal" placeholder="Aantal" step="0.01" value="${data.aantal||''}"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>&lt;input type="text" <span class="Apple-converted-space">  </span>class="matEenheid" placeholder="Eenheid" value="${data.eenheid||''}"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>&lt;input type="text" <span class="Apple-converted-space">  </span>class="matArtNr" placeholder="Art.nr." value="${data.artNr||''}"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>&lt;input type="number" class="matPrijs" placeholder="Prijs/st" step="0.01" value="${data.prijs||''}"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>&lt;button type="button" class="btn danger" onclick="removeMaterialRow(this)"&gt;×&lt;/button&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>`;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>container.appendChild(row);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>row.querySelectorAll('input,select').forEach(el=&gt;el.addEventListener('input', bereken));</span></p>
<p class="p1"><span class="s1">}</span></p>
<p class="p1"><span class="s1">function removeMaterialRow(btn){</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>btn.parentElement.remove();</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>bereken();</span></p>
<p class="p1"><span class="s1">}</span></p>
<p class="p1"><span class="s1">function getMaterialTotal(){</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>let tot = 0;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>document.querySelectorAll('.material-row').forEach(row=&gt;{</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>const aantal = parseFloat(row.querySelector('.matAantal').value) || 0;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>const prijs<span class="Apple-converted-space">  </span>= parseFloat(row.querySelector('.matPrijs').value)<span class="Apple-converted-space">  </span>|| 0;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>tot += aantal * prijs;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>});</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>return tot;</span></p>
<p class="p1"><span class="s1">}</span></p>
<p class="p1"><span class="s1">function getMaterialRowsArray(){</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>const rows = [];</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>document.querySelectorAll('.material-row').forEach(row=&gt;{</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>rows.push({</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>type:<span class="Apple-converted-space">        </span>row.querySelector('.matType').value,</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>leverancier: row.querySelector('.matLeverancier').value,</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>aantal:<span class="Apple-converted-space">      </span>row.querySelector('.matAantal').value,</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>eenheid: <span class="Apple-converted-space">    </span>row.querySelector('.matEenheid').value,</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>artNr: <span class="Apple-converted-space">      </span>row.querySelector('.matArtNr').value,</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>prijs: <span class="Apple-converted-space">      </span>row.querySelector('.matPrijs').value</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>});</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>});</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>return rows;</span></p>
<p class="p1"><span class="s1">}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">/* ---------- SAVE / EXPORT / RESET ---------- */</span></p>
<p class="p1"><span class="s1">function saveCalc(){</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>const c = {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>projName:<span class="Apple-converted-space">    </span>document.getElementById('projName').value,</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>custName:<span class="Apple-converted-space">    </span>document.getElementById('custName').value,</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>projAdres: <span class="Apple-converted-space">  </span>document.getElementById('projAdres').value,</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>status:<span class="Apple-converted-space">      </span>document.getElementById('status').value,</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>vlOppervl: <span class="Apple-converted-space">  </span>document.getElementById('vlOppervl').value,</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>vlType:<span class="Apple-converted-space">      </span>document.getElementById('vlType').value,</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>vlProd:<span class="Apple-converted-space">      </span>document.getElementById('vlProd').value,</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>vlPrijs: <span class="Apple-converted-space">    </span>document.getElementById('vlPrijs').value,</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>zaagV: <span class="Apple-converted-space">      </span>document.getElementById('zaagV').value,</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>vlTotaal:<span class="Apple-converted-space">    </span>document.getElementById('vlTotaal').value,</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>ondVereist:<span class="Apple-converted-space">  </span>document.getElementById('ondVereist').checked,</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>ondKeuze:<span class="Apple-converted-space">    </span>document.getElementById('ondKeuze').value,</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>ondPrijs:<span class="Apple-converted-space">    </span>document.getElementById('ondPrijs').value,</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>omtrek:<span class="Apple-converted-space">      </span>document.getElementById('omtrek').value,</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>plintKeuze:<span class="Apple-converted-space">  </span>document.getElementById('plintKeuze').value,</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>plintPrijs:<span class="Apple-converted-space">  </span>document.getElementById('plintPrijs').value,</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>materialRows:getMaterialRowsArray(),</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>leggen:<span class="Apple-converted-space">      </span>document.getElementById('leggen').value,</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>legToeslag:<span class="Apple-converted-space">  </span>document.getElementById('legToeslag').value,</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>egal:<span class="Apple-converted-space">        </span>document.getElementById('egal').value,</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>oudVloer:<span class="Apple-converted-space">    </span>document.getElementById('oudVloer').value,</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>vrijKosten:<span class="Apple-converted-space">  </span>document.getElementById('vrijKosten').value,</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>vrijTekst: <span class="Apple-converted-space">  </span>document.getElementById('vrijTekst').value,</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>subMat:<span class="Apple-converted-space">      </span>document.getElementById('subMat').innerText,</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>subArb:<span class="Apple-converted-space">      </span>document.getElementById('subArb').innerText,</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>totNetto:<span class="Apple-converted-space">    </span>document.getElementById('totNetto').innerText,</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>btw: <span class="Apple-converted-space">        </span>document.getElementById('btw').innerText,</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>totBruto:<span class="Apple-converted-space">    </span>document.getElementById('totBruto').innerText,</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>date:<span class="Apple-converted-space">        </span>new Date().toISOString()</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>};</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>STORE.setCalc(c);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>STORE.addOfferte(c);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>switchTab({target:{}},'quote');</span></p>
<p class="p1"><span class="s1">}</span></p>
<p class="p1"><span class="s1">function exportCSV(){</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>const c = STORE.getCalc();</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>if (!c.projName) { alert('Niets om te exporteren – sla eerst op.'); return; }</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>let csv = 'Veld,Waarde\n';</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>for (const k in c) { csv += `"${k}","${c[k]}"\n`; }</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>const blob = new Blob([csv], {type:'text/csv;charset=utf-8;'});</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>const a = document.createElement('a');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>a.href = URL.createObjectURL(blob);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>a.download = `calculatie_${c.projName.replace(/\s+/g,'_')}.csv`;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>a.click();</span></p>
<p class="p1"><span class="s1">}</span></p>
<p class="p1"><span class="s1">function resetForm(){</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>document.querySelectorAll('#calc input, #calc select, #calc textarea')</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>.forEach(el=&gt;{ if (el.type==='checkbox') el.checked = false; else el.value = ''; });</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>document.getElementById('materialContainer').innerHTML = '';</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>addMaterialRow();</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>localStorage.removeItem('calc');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>bereken();</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>switchTab({target:{}},'calc');</span></p>
<p class="p1"><span class="s1">}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">/* ---------- QUOTE ---------- */</span></p>
<p class="p1"><span class="s1">function renderQuote(){</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>const c = STORE.getCalc();</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>if (!c.projName){</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>document.getElementById('quotePreview').innerHTML = '&lt;p&gt;Geen offerte beschikbaar.&lt;/p&gt;';</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>return;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>const logoB64 = ''; <span class="Apple-converted-space">  </span>// ← optional base‑64 logo</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>const vloerOms = (c.vlType === 'Vloerbedekking') ? 'Vloerbedekking' : `${c.vlType} vloer`;</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>let materialRowsHtml = '';</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>if (c.materialRows &amp;&amp; c.materialRows.length){</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>c.materialRows.forEach(r=&gt;{</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>const qty = parseFloat(r.aantal) || 0;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>const price = parseFloat(r.prijs) || 0;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>const tot = qty * price;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>materialRowsHtml += `</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>&lt;tr&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>&lt;td&gt;${r.type} (${r.leverancier} - ${r.artNr})&lt;/td&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>&lt;td class="nr"&gt;${r.aantal} ${r.eenheid}&lt;/td&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>&lt;td class="nr"&gt;€ ${price.toFixed(2)}&lt;/td&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>&lt;td class="nr"&gt;€ ${tot.toFixed(2)}&lt;/td&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>&lt;/tr&gt;`;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>});</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>const html = `</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>&lt;div class="print-header"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>&lt;img src="data:image/png;base64,${logoB64}" alt="Logo"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>&lt;div class="co-info"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>&lt;strong&gt;Next Generation Flooring&lt;/strong&gt;&lt;br&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>Josephine Bakerstraat 18&lt;br&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>1311 GA Almere&lt;br&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>Tel: +31 020 210 1184&lt;br&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>E‑mail: info@nextgenerationflooring.nl</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>&lt;/div&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>&lt;/div&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>&lt;div class="row"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>&lt;div class="col"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>&lt;h2&gt;Offerte ${c.projName}&lt;/h2&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>&lt;table class="meta"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>&lt;tr&gt;&lt;td&gt;Offertenummer:&lt;/td&gt;&lt;td&gt;NG-${c.id}&lt;/td&gt;&lt;/tr&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>&lt;tr&gt;&lt;td&gt;Datum:&lt;/td&gt;&lt;td&gt;${new Date(c.date).toLocaleDateString('nl-NL')}&lt;/td&gt;&lt;/tr&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>&lt;tr&gt;&lt;td&gt;Klant:&lt;/td&gt;&lt;td&gt;${c.custName||''}&lt;/td&gt;&lt;/tr&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>&lt;tr&gt;&lt;td&gt;Projectadres:&lt;/td&gt;&lt;td&gt;${c.projAdres||''}&lt;/td&gt;&lt;/tr&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>&lt;tr&gt;&lt;td&gt;Geldigheid:&lt;/td&gt;&lt;td&gt;30 dagen&lt;/td&gt;&lt;/tr&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>&lt;/table&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>&lt;/div&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>&lt;div class="col"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>&lt;img class="preview-img" src="https://source.unsplash.com/900x600/?floor,${c.vlType}"</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                     </span>alt="${c.vlProd||'Gekozen vloer'}"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>&lt;/div&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>&lt;/div&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>&lt;div class="row"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>&lt;div class="col"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>&lt;h3&gt;Prijsopbouw (€ incl. 21 % BTW)&lt;/h3&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>&lt;table class="details"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>&lt;thead&gt;&lt;tr&gt;&lt;th&gt;Omschrijving&lt;/th&gt;&lt;th class="nr"&gt;aantal&lt;/th&gt;&lt;th class="nr"&gt;€ / eenh.&lt;/th&gt;&lt;th class="nr"&gt;bedrag&lt;/th&gt;&lt;/tr&gt;&lt;/thead&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>&lt;tbody&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span>&lt;tr&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                            </span>&lt;td&gt;${vloerOms}&lt;/td&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                            </span>&lt;td class="nr"&gt;${c.vlTotaal} m²&lt;/td&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                            </span>&lt;td class="nr"&gt;€ ${parseFloat(c.vlPrijs).toFixed(2)}&lt;/td&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                            </span>&lt;td class="nr"&gt;€ ${(parseFloat(c.vlTotaal)*parseFloat(c.vlPrijs)).toFixed(2)}&lt;/td&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span>&lt;/tr&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span>${c.ondVereist ? `</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span>&lt;tr&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                            </span>&lt;td&gt;Ondervloer ${c.ondKeuze}&lt;/td&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                            </span>&lt;td class="nr"&gt;${c.vlOppervl} m²&lt;/td&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                            </span>&lt;td class="nr"&gt;€ ${parseFloat(c.ondPrijs).toFixed(2)}&lt;/td&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                            </span>&lt;td class="nr"&gt;€ ${(parseFloat(c.vlOppervl)*parseFloat(c.ondPrijs)).toFixed(2)}&lt;/td&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span>&lt;/tr&gt;` : ''}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span>&lt;tr&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                            </span>&lt;td&gt;Plinten ${c.plintKeuze}&lt;/td&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                            </span>&lt;td class="nr"&gt;${c.omtrek} m&lt;/td&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                            </span>&lt;td class="nr"&gt;€ ${parseFloat(c.plintPrijs).toFixed(2)}&lt;/td&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                            </span>&lt;td class="nr"&gt;€ ${(parseFloat(c.omtrek)*parseFloat(c.plintPrijs)).toFixed(2)}&lt;/td&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span>&lt;/tr&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span>${materialRowsHtml}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span>&lt;tr&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                            </span>&lt;td&gt;Arbeid &amp;amp; service&lt;/td&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                            </span>&lt;td class="nr"&gt;&lt;/td&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                            </span>&lt;td class="nr"&gt;&lt;/td&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                            </span>&lt;td class="nr"&gt;€ ${parseFloat(c.subArb).toFixed(2)}&lt;/td&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span>&lt;/tr&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span>&lt;tr class="tot"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                            </span>&lt;td&gt;&lt;strong&gt;Totaal incl. 21 % BTW&lt;/strong&gt;&lt;/td&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                            </span>&lt;td class="nr"&gt;&lt;/td&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                            </span>&lt;td class="nr"&gt;&lt;/td&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                            </span>&lt;td class="nr"&gt;&lt;strong&gt;€ ${parseFloat(c.totBruto).toFixed(2)}&lt;/strong&gt;&lt;/td&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                        </span>&lt;/tr&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>&lt;/tbody&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>&lt;/table&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>&lt;/div&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>&lt;/div&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>&lt;div class="row"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>&lt;div class="col"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>&lt;h3&gt;Levering &amp;amp; garantie&lt;/h3&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>&lt;ul&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>&lt;li&gt;Levertijd: 5‑10 werkdagen na akkoord&lt;/li&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>&lt;li&gt;10 jaar woon‑garantie op de vloer&lt;/li&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>&lt;li&gt;2 jaar garantie op gehele installatie&lt;/li&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                    </span>&lt;li&gt;Professionele legservice inbegrepen&lt;/li&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>&lt;/ul&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>&lt;p&gt;&lt;strong&gt;Opmerkingen:&lt;/strong&gt; ${c.vrijTekst||'Geen bijzonderheden.'}&lt;/p&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>&lt;/div&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>&lt;/div&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>&lt;div class="row"&gt;&lt;div class="col"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>&lt;button class="btn success" onclick="alert('Bedankt – u ontvangt binnen 1 uur een bevestiging per e‑mail!')"&gt;Offerte digitaal ondertekenen&lt;/button&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>&lt;button class="btn secondary" onclick="window.print()"&gt;Download / print PDF&lt;/button&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>&lt;/div&gt;&lt;/div&gt;`;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>document.getElementById('quotePreview').innerHTML = html;</span></p>
<p class="p1"><span class="s1">}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">/* ---------- MANAGEMENT ---------- */</span></p>
<p class="p1"><span class="s1">function renderMgmt(){</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>const list = STORE.getOffertes();</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>const won = list.filter(o =&gt; o.status === 'Gewonnen');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>const verzonden = list.filter(o =&gt; ['Verzonden','Aangepast','Gewonnen','Verloren'].includes(o.status));</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>const aov = won.length ? won.reduce((s,o)=&gt;s+parseFloat(o.totBruto),0) / won.length : 0;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>const conv = verzonden.length ? (won.length / verzonden.length) * 100 : 0;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>const pipeline = list.filter(o=&gt;['Concept','Verzonden','Aangepast'].includes(o.status))</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                         </span>.reduce((s,o)=&gt;s+parseFloat(o.totBruto),0);</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>document.querySelector('#kpiAOV span').innerText = aov.toFixed(0);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>document.querySelector('#kpiConv span').innerText = conv.toFixed(1);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>document.querySelector('#kpiPipe span').innerText = pipeline.toFixed(0);</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>// pipeline bar chart – counts per status</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>drawBar('pipeChart',{</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>labels:['Concept','Verzonden','Aangepast','Gewonnen','Verloren'],</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>data:[</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>list.filter(o=&gt;o.status==='Concept').length,</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>list.filter(o=&gt;o.status==='Verzonden').length,</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>list.filter(o=&gt;o.status==='Aangepast').length,</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>won.length,</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>list.filter(o=&gt;o.status==='Verloren').length</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>]</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>});</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>// static loss‑reason pie chart</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>drawPie('lossChart',['Prijs te hoog','Levertijd','Product niet beschikbaar','Andere'],</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>[40,25,20,15]);</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>// omzet per vloer‑type (only won)</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>const omzet = {};</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>list.forEach(o=&gt;{</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>if (o.status==='Gewonnen'){</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>const t = o.vlType||'Onbekend';</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>omzet[t] = (omzet[t]||0) + parseFloat(o.totBruto);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>});</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>drawBar('prodChart',{labels:Object.keys(omzet),data:Object.values(omzet)});</span></p>
<p class="p1"><span class="s1">}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">/* ---------- CHART HELPERS ---------- */</span></p>
<p class="p1"><span class="s1">function drawBar(canvasId,{labels,data}){</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>const canvas = document.getElementById(canvasId);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>const ctx = canvas.getContext('2d');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>const pad = 30;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>const w = canvas.width = canvas.offsetWidth;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>const h = canvas.height = 160;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>const slot = (w-2*pad)/labels.length;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>const barW = slot*0.7;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>const gap<span class="Apple-converted-space">  </span>= slot*0.3;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>const maxV = Math.max(...data,1);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>ctx.clearRect(0,0,w,h);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>labels.forEach((lbl,i)=&gt;{</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>const val = data[i];</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>const bh = (val/maxV)*(h-2*pad);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>const x = pad + i*slot + gap/2;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>const y = h - pad - bh;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>ctx.fillStyle = '#0d47a1';</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>ctx.fillRect(x,y,barW,bh);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>ctx.fillStyle = '#000';</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>ctx.font = '12px sans-serif';</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>ctx.textAlign = 'center';</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>ctx.fillText(val, x+barW/2, y-4);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>ctx.fillText(lbl, x+barW/2, h-pad+14);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>});</span></p>
<p class="p1"><span class="s1">}</span></p>
<p class="p1"><span class="s1">function drawPie(canvasId,labels,data){</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>const canvas = document.getElementById(canvasId);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>const ctx = canvas.getContext('2d');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>const w = canvas.width = canvas.offsetWidth;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>const h = canvas.height = 160;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>const R = Math.min(w,h)/2 - 20;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>const total = data.reduce((a,b)=&gt;a+b,0);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>const colors = ['#c62828','#ff6f00','#2e7d32','#0277bd','#9c27b0','#ff9800'];</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>ctx.clearRect(0,0,w,h);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>let start = 0;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>data.forEach((val,i)=&gt;{</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>const angle = (val/total)*2*Math.PI;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>ctx.beginPath();</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>ctx.moveTo(w/2,h/2);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>ctx.arc(w/2,h/2,R,start,start+angle);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>ctx.closePath();</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>ctx.fillStyle = colors[i%colors.length];</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>ctx.fill();</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>start += angle;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>});</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>// simple legend (optional)</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>const legX = w - 110;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>let legY = 20;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>ctx.font = '12px sans-serif';</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>labels.forEach((lab,i)=&gt;{</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>ctx.fillStyle = colors[i%colors.length];</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>ctx.fillRect(legX,legY-12,12,12);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>ctx.fillStyle = '#000';</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>ctx.fillText(`${lab} (${data[i]})`,legX+18,legY);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>legY += 20;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>});</span></p>
<p class="p1"><span class="s1">}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">/* ---------- DEMO DATA (reset) ---------- */</span></p>
<p class="p1"><span class="s1">function resetData(){</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>localStorage.removeItem('calc');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>localStorage.removeItem('offertes');</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>const demo = [</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>{</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>projName:'Demo Project 1',</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>custName:'Demo Klant',</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>projAdres:'Straat 1, 1234 AB Demo',</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>status:'Gewonnen',</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>vlOppervl:'30',</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>vlType:'PVC',</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>vlProd:'Demo Vloer',</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>vlPrijs:'25',</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>zaagV:'5',</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>vlTotaal:(30*1.05).toFixed(2),</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>ondVereist:true,</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>ondKeuze:'Beton',</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>ondPrijs:'5',</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>omtrek:'12',</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>plintKeuze:'Eiken',</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>plintPrijs:'3',</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>materialRows:[],</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>leggen:'15',</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>legToeslag:'0',</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>egal:'5',</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>oudVloer:'0',</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>vrijKosten:'50',</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>vrijTekst:'',</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>date:new Date().toISOString()</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>},</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>{</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>projName:'Demo Project 2',</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>custName:'Klant B',</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>projAdres:'Straat 2, 5678 CD Demo',</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>status:'Concept',</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>vlOppervl:'45',</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>vlType:'Laminaat',</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>vlProd:'Voorbeeld Laminaat',</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>vlPrijs:'20',</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>zaagV:'5',</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>vlTotaal:(45*1.05).toFixed(2),</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>ondVereist:false,</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>ondKeuze:'',</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>ondPrijs:'',</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>omtrek:'15',</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>plintKeuze:'Geen',</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>plintPrijs:'0',</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>materialRows:[],</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>leggen:'12',</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>legToeslag:'0',</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>egal:'4',</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>oudVloer:'2',</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>vrijKosten:'30',</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>vrijTekst:'',</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>date:new Date().toISOString()</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>];</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>// compute totals for the demo rows</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>demo.forEach(o=&gt;{</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>const vl = parseFloat(o.vlOppervl);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>const zv = parseFloat(o.zaagV);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>const vt = vl * (1 + zv/100);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>const subMat = (vt * parseFloat(o.vlPrijs)) +</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                      </span>(vl * (o.ondVereist ? parseFloat(o.ondPrijs) : 0)) +</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                      </span>(parseFloat(o.omtrek) * parseFloat(o.plintPrijs));</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>const subArb = (vl * parseFloat(o.leggen)) +</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                      </span>(vl * parseFloat(o.legToeslag)) +</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                      </span>(vl * parseFloat(o.egal)) +</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                      </span>(vl * parseFloat(o.oudVloer)) +</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                      </span>parseFloat(o.vrijKosten);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>const netto = subMat + subArb;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>const btw <span class="Apple-converted-space">  </span>= netto * 0.21;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>const bruto = netto + btw;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>o.subMat <span class="Apple-converted-space">  </span>= subMat.toFixed(2);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>o.subArb <span class="Apple-converted-space">  </span>= subArb.toFixed(2);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>o.totNetto = netto.toFixed(2);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>o.btw<span class="Apple-converted-space">      </span>= btw.toFixed(2);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>o.totBruto = bruto.toFixed(2);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>});</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>STORE.setOffertes(demo);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>switchTab({target:{}},'mgmt');</span></p>
<p class="p1"><span class="s1">}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">/* ---------- START ---------- */</span></p>
<p class="p1"><span class="s1">(function(){</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>addMaterialRow(); <span class="Apple-converted-space">                    </span>// start with a single empty material line</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>const saved = STORE.getCalc();</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>if (saved.projName){</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>if (saved.materialRows &amp;&amp; saved.materialRows.length){</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>document.getElementById('materialContainer').innerHTML = '';</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>saved.materialRows.forEach(r=&gt;addMaterialRow(r));</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>Object.keys(saved).forEach(k=&gt;{</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>const el = document.getElementById(k);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>if (el){</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>if (el.type === 'checkbox') el.checked = saved[k];</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">                </span>else el.value = saved[k];</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">            </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>});</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">        </span>bereken();</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">    </span>if (!STORE.getOffertes().length) resetData();</span></p>
<p class="p1"><span class="s1">})();</span></p>
<p class="p1"><span class="s1">&lt;/script&gt;</span></p>
<p class="p1"><span class="s1">&lt;/body&gt;</span></p>
<p class="p1"><span class="s1">&lt;/html&gt;</span></p>
</body>
</html>
