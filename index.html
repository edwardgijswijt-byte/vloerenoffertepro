<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
  <meta http-equiv="Content-Style-Type" content="text/css">
  <title></title>
  <meta name="Generator" content="Cocoa HTML Writer">
  <meta name="CocoaVersion" content="2575.7">
  <style type="text/css">
    body {background-color: #f2f5f9}
    p.p1 {margin: 0.0px 0.0px 0.0px 0.0px; font: 14.0px Menlo; color: #2a2c33; background-color: #ffffff}
    p.p2 {margin: 0.0px 0.0px 0.0px 0.0px; font: 14.0px Menlo; color: #2a2c33; background-color: #ffffff; min-height: 16.0px}
    span.s1 {font-kerning: none}
    span.s2 {font: 14.0px 'Apple Color Emoji'; font-kerning: none}
  </style>
</head>
<body>
<p class="p1"><span class="s1">&lt;!DOCTYPE html&gt;</span></p>
<p class="p1"><span class="s1">&lt;html lang="nl"&gt;</span></p>
<p class="p1"><span class="s1">&lt;head&gt;</span></p>
<p class="p1"><span class="s1">&lt;meta charset="utf-8"&gt;</span></p>
<p class="p1"><span class="s1">&lt;title&gt;VloerenOffertePro&lt;/title&gt;</span></p>
<p class="p1"><span class="s1">&lt;meta name="viewport" content="width=device-width, initial-scale=1"&gt;</span></p>
<p class="p1"><span class="s1">&lt;style&gt;</span></p>
<p class="p1"><span class="s1">:root{--primary:#0d47a1;--secondary:#ff6f00;--ok:#2e7d32;--danger:#c62828;--bg:#f5f7fa;--card:#fff;--text:#212121;--mute:#757575;--radius:6px;}</span></p>
<p class="p1"><span class="s1">*{box-sizing:border-box;font-family:'Segoe UI',Roboto,Helvetica,Arial,sans-serif;}</span></p>
<p class="p1"><span class="s1">body{margin:0;background:var(--bg);color:var(--text);}</span></p>
<p class="p1"><span class="s1">h1,h2,h3{margin:0 0 .5em;font-weight:600;}</span></p>
<p class="p1"><span class="s1">.tabs{display:flex;border-bottom:2px solid var(--primary);}</span></p>
<p class="p1"><span class="s1">.tabs button{flex:1;padding:12px;font-size:16px;border:none;background:#fff;cursor:pointer;transition:.2s;color:var(--primary);}</span></p>
<p class="p1"><span class="s1">.tabs button.active{background:var(--primary);color:#fff;}</span></p>
<p class="p1"><span class="s1">.tab-content{display:none;padding:20px;}</span></p>
<p class="p1"><span class="s1">.tab-content.active{display:block;}</span></p>
<p class="p1"><span class="s1">.row{display:flex;gap:20px;margin-bottom:20px;flex-wrap:wrap;}</span></p>
<p class="p1"><span class="s1">.col{flex:1;min-width:280px;background:var(--card);padding:18px;border-radius:var(--radius);box-shadow:0 1px 3px rgba(0,0,0,.08);}</span></p>
<p class="p1"><span class="s1">label{display:block;margin:.5em 0 .2em;font-weight:600;font-size:14px;}</span></p>
<p class="p1"><span class="s1">input,select,textarea{width:100%;padding:8px 10px;border:1px solid #bbb;border-radius:var(--radius);}</span></p>
<p class="p1"><span class="s1">input[type=checkbox]{width:auto;margin-right:6px;}</span></p>
<p class="p1"><span class="s1">.btn{padding:10px 18px;border:none;border-radius:var(--radius);cursor:pointer;font-size:15px;background:var(--primary);color:#fff;margin-top:10px;margin-right:8px;}</span></p>
<p class="p1"><span class="s1">.btn.secondary{background:var(--secondary);}</span></p>
<p class="p1"><span class="s1">.btn.danger{background:var(--danger);}</span></p>
<p class="p1"><span class="s1">.btn.success{background:var(--ok);}</span></p>
<p class="p1"><span class="s1">.kpi{background:var(--primary);color:#fff;padding:20px;border-radius:var(--radius);text-align:center;font-size:26px;font-weight:700;margin-bottom:20px;}</span></p>
<p class="p1"><span class="s1">table{width:100%;border-collapse:collapse;font-size:14px;}</span></p>
<p class="p1"><span class="s1">th,td{padding:8px 10px;text-align:left;border-bottom:1px solid #e0e0e0;}</span></p>
<p class="p1"><span class="s1">th{background:#fafafa;}</span></p>
<p class="p1"><span class="s1">.preview-img{max-width:100%;max-height:220px;border-radius:var(--radius);}</span></p>
<p class="p1"><span class="s1">canvas{max-width:100%;}</span></p>
<p class="p1"><span class="s1">/* ===== PRINT ===== */</span></p>
<p class="p1"><span class="s1">@media screen {.print-header{display:none;}}</span></p>
<p class="p1"><span class="s1">@media print{</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  </span>body{background:#fff;color:#000;margin:0;}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  </span>.tabs,.btn{display:none !important;}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  </span>.print-header{display:flex;align-items:center;justify-content:space-between;margin-bottom:20px;border-bottom:2px solid var(--primary);padding-bottom:10px;}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  </span>.print-header img{height:60px;}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  </span>.print-header .co-info{text-align:right;font-size:13px;line-height:1.4;}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  </span>.row{page-break-inside:avoid;}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  </span>table.details th.nr,table.details td.nr{text-align:right;}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  </span>table.details tr.tot{background:#f5f5f5;font-weight:700;}</span></p>
<p class="p1"><span class="s1">}</span></p>
<p class="p1"><span class="s1">.material-row{display:grid;grid-template-columns:1fr 1fr 1fr 1fr 1fr 1fr auto;gap:8px;margin-bottom:8px;align-items:center;}</span></p>
<p class="p1"><span class="s1">.material-row input,.material-row select{padding:6px;font-size:13px;}</span></p>
<p class="p1"><span class="s1">&lt;/style&gt;</span></p>
<p class="p1"><span class="s1">&lt;/head&gt;</span></p>
<p class="p1"><span class="s1">&lt;body&gt;</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">&lt;div class="tabs"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>&lt;button class="active" onclick="switchTab(event,'calc')"&gt;Calculatie&lt;/button&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>&lt;button onclick="switchTab(event,'quote')"&gt;Offerte&lt;/button&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>&lt;button onclick="switchTab(event,'mgmt')"&gt;Management&lt;/button&gt;</span></p>
<p class="p1"><span class="s1">&lt;/div&gt;</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">&lt;!-- ========================== CALCULATIE ========================== --&gt;</span></p>
<p class="p1"><span class="s1">&lt;div id="calc" class="tab-content active"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>&lt;h1&gt;1. Project &amp;amp; Klantgegevens&lt;/h1&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>&lt;div class="row"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>&lt;div class="col"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>&lt;label&gt;Projectnaam *&lt;/label&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>&lt;input id="projName" placeholder="Woonkamer Familie De Vries"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>&lt;label&gt;Klantnaam&lt;/label&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>&lt;input id="custName" placeholder="Zoek of typ"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>&lt;label&gt;Projectadres *&lt;/label&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>&lt;input id="projAdres" placeholder="Straat 1, 1234 AB Stad"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>&lt;label&gt;Status&lt;/label&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>&lt;select id="status"&gt;&lt;option&gt;Concept&lt;/option&gt;&lt;option&gt;Verzonden&lt;/option&gt;&lt;option&gt;Aangepast&lt;/option&gt;&lt;option&gt;Gewonnen&lt;/option&gt;&lt;option&gt;Verloren&lt;/option&gt;&lt;/select&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>&lt;/div&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>&lt;/div&gt;</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>&lt;h1&gt;2. Vloerkeuze &amp;amp; Hoeveelheden&lt;/h1&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>&lt;div class="row"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>&lt;div class="col"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>&lt;label&gt;Vloeroppervlakte (mÂ²) *&lt;/label&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>&lt;input id="vlOppervl" type="number" step="0.1" oninput="bereken()"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>&lt;label&gt;Vloertype *&lt;/label&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>&lt;select id="vlType" oninput="bereken()"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;option value=""&gt;Kies...&lt;/option&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;option&gt;PVC&lt;/option&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;option&gt;Laminaat&lt;/option&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;option&gt;Hout&lt;/option&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;option&gt;Gietvloer&lt;/option&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;option&gt;Tegels&lt;/option&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;option&gt;Vloerbedekking&lt;/option&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>&lt;/select&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>&lt;label&gt;Product (Merk / Kleur)&lt;/label&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>&lt;input id="vlProd" placeholder="Quick-Step Classic â€“ Eik Wit"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>&lt;label&gt;Afwerking&lt;/label&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>&lt;select id="afwerk"&gt;&lt;option&gt;Mat&lt;/option&gt;&lt;option&gt;Zijdeglans&lt;/option&gt;&lt;option&gt;Structuur&lt;/option&gt;&lt;/select&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>&lt;label&gt;Zaagverlies (%)&lt;/label&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>&lt;input id="zaagV" type="number" step="0.1" value="5" oninput="bereken()"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>&lt;label&gt;Netto vloerprijs (â‚¬/mÂ² excl.)&lt;/label&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>&lt;input id="vlPrijs" type="number" step="0.01" oninput="bereken()"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>&lt;label&gt;Totaal mÂ² vloer (incl. zaagverlies)&lt;/label&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>&lt;input id="vlTotaal" readonly&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>&lt;/div&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>&lt;/div&gt;</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>&lt;h1&gt;3. Ondervloer, Plinten &amp;amp; Toebehoren&lt;/h1&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>&lt;div class="row"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>&lt;div class="col"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>&lt;label&gt;&lt;input id="ondVereist" type="checkbox" oninput="bereken()"&gt; Ondervloer vereist?&lt;/label&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>&lt;label&gt;Ondervloer selectie&lt;/label&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>&lt;select id="ondKeuze" oninput="bereken()"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;option value=""&gt;Kies...&lt;/option&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;option&gt;Beton&lt;/option&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;option&gt;Hout&lt;/option&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;option&gt;Polystyreen&lt;/option&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;option&gt;Anders&lt;/option&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>&lt;/select&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>&lt;label&gt;Ondervloer prijs (â‚¬/mÂ²)&lt;/label&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>&lt;input id="ondPrijs" type="number" step="0.01" oninput="bereken()"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>&lt;label&gt;Plint omtrek (m)&lt;/label&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>&lt;input id="omtrek" type="number" step="0.1" oninput="bereken()"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>&lt;label&gt;Plint selectie&lt;/label&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>&lt;select id="plintKeuze" oninput="bereken()"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;option value=""&gt;Kies...&lt;/option&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;option&gt;Eiken&lt;/option&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;option&gt;Duifenkast&lt;/option&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;option&gt;Geen&lt;/option&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>&lt;/select&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>&lt;label&gt;Plint prijs (â‚¬/m)&lt;/label&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>&lt;input id="plintPrijs" type="number" step="0.01" oninput="bereken()"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>&lt;/div&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>&lt;/div&gt;</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>&lt;h1&gt;4. Overige materialen (meerdere regels)&lt;/h1&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>&lt;div class="row"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>&lt;div class="col"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>&lt;div id="materialContainer"&gt;&lt;/div&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>&lt;button type="button" class="btn secondary" onclick="addMaterialRow()"&gt;+ Regel toevoegen&lt;/button&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>&lt;/div&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>&lt;/div&gt;</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>&lt;h1&gt;5. Arbeid &amp;amp; Service&lt;/h1&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>&lt;div class="row"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>&lt;div class="col"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>&lt;label&gt;Leggen vloer (â‚¬/mÂ²)&lt;/label&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>&lt;input id="leggen" type="number" step="0.01" oninput="bereken()"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>&lt;label&gt;Leggen toeslag (â‚¬/mÂ² of %)&lt;/label&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>&lt;input id="legToeslag" type="number" step="0.01" placeholder="0" oninput="bereken()"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>&lt;label&gt;Egaliseren (â‚¬/mÂ²)&lt;/label&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>&lt;input id="egal" type="number" step="0.01" oninput="bereken()"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>&lt;label&gt;Oude vloer verwijderen (â‚¬/mÂ²)&lt;/label&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>&lt;input id="oudVloer" type="number" step="0.01" oninput="bereken()"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>&lt;label&gt;Voorrijkosten / transport â‚¬&lt;/label&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>&lt;input id="vrijKosten" type="number" step="0.01" oninput="bereken()"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>&lt;label&gt;Vrij tekst (condities)&lt;/label&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>&lt;textarea id="vrijTekst" rows="3" placeholder="Niet inbegrepen: verwijdering meubels..."&gt;&lt;/textarea&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>&lt;/div&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>&lt;/div&gt;</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>&lt;h1&gt;6. Finale Prijscalculatie&lt;/h1&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>&lt;div class="row"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>&lt;div class="col"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>&lt;table&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;tr&gt;&lt;th&gt;Post&lt;/th&gt;&lt;th&gt;Bedrag (â‚¬ excl.)&lt;/th&gt;&lt;/tr&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;tr&gt;&lt;td&gt;Subtotaal Materialen&lt;/td&gt;&lt;td id="subMat"&gt;0.00&lt;/td&gt;&lt;/tr&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;tr&gt;&lt;td&gt;Subtotaal Arbeid&lt;/td&gt;&lt;td id="subArb"&gt;0.00&lt;/td&gt;&lt;/tr&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;tr&gt;&lt;td&gt;Totaal Netto&lt;/td&gt;&lt;td id="totNetto"&gt;0.00&lt;/td&gt;&lt;/tr&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;tr&gt;&lt;td&gt;BTW 21%&lt;/td&gt;&lt;td id="btw"&gt;0.00&lt;/td&gt;&lt;/tr&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;tr&gt;&lt;td&gt;&lt;strong&gt;Totaal Offerteprijs (Bruto)&lt;/strong&gt;&lt;/td&gt;&lt;td id="totBruto"&gt;&lt;strong&gt;0.00&lt;/strong&gt;&lt;/td&gt;&lt;/tr&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>&lt;/table&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>&lt;button class="btn success" onclick="saveCalc()"&gt;Opslaan &amp;amp; Offerte Tonen&lt;/button&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>&lt;button type="button" class="btn danger" onclick="resetForm()"&gt;</span><span class="s2">ðŸ—‘</span><span class="s1"> Nieuw formulier&lt;/button&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>&lt;button type="button" class="btn secondary" onclick="exportCSV()"&gt;Export CSV&lt;/button&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>&lt;/div&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>&lt;/div&gt;</span></p>
<p class="p1"><span class="s1">&lt;/div&gt;</span></p>
<p class="p1"><span class="s1">&lt;!-- ========================== OFFERTES ========================== --&gt;</span></p>
<p class="p1"><span class="s1">&lt;div id="quote" class="tab-content"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>&lt;div id="quotePreview"&gt;&lt;/div&gt;</span></p>
<p class="p1"><span class="s1">&lt;/div&gt;</span></p>
<p class="p1"><span class="s1">&lt;!-- ========================== MANAGEMENT ======================= --&gt;</span></p>
<p class="p1"><span class="s1">&lt;div id="mgmt" class="tab-content"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>&lt;h1&gt;Management Dashboard&lt;/h1&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>&lt;div class="row"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>&lt;div class="col"&gt;&lt;div class="kpi" id="kpiAOV"&gt;Gem. Orderwaarde&lt;br/&gt;â‚¬ &lt;span&gt;0&lt;/span&gt;&lt;/div&gt;&lt;/div&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>&lt;div class="col"&gt;&lt;div class="kpi" id="kpiConv"&gt;Conversie&lt;br/&gt;&lt;span&gt;0&lt;/span&gt; %&lt;/div&gt;&lt;/div&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>&lt;div class="col"&gt;&lt;div class="kpi" id="kpiPipe"&gt;Pipeline&lt;br/&gt;â‚¬ &lt;span&gt;0&lt;/span&gt;&lt;/div&gt;&lt;/div&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>&lt;/div&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>&lt;h2&gt;Offerteâ€‘Pijplijn&lt;/h2&gt;&lt;canvas id="pipeChart" height="120"&gt;&lt;/canvas&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>&lt;h2&gt;Redenen Verloren&lt;/h2&gt;&lt;canvas id="lossChart" height="120"&gt;&lt;/canvas&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>&lt;h2&gt;Performance per Productgroep&lt;/h2&gt;&lt;canvas id="prodChart" height="120"&gt;&lt;/canvas&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>&lt;button class="btn" onclick="resetData()"&gt;Reset demo data&lt;/button&gt;</span></p>
<p class="p1"><span class="s1">&lt;/div&gt;</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">&lt;script&gt;</span></p>
<p class="p1"><span class="s1">/* ---------- GLOBAL STORE ---------- */</span></p>
<p class="p1"><span class="s1">const STORE = {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>getCalc() { return JSON.parse(localStorage.getItem('calc') || '{}'); },</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>setCalc(obj) { localStorage.setItem('calc', JSON.stringify(obj)); },</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>getOffertes() { return JSON.parse(localStorage.getItem('offertes') || '[]'); },</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>setOffertes(arr) { localStorage.setItem('offertes', JSON.stringify(arr)); },</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>addOfferte(o) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>const arr = this.getOffertes();</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>const newObj = { ...o };</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>if (!newObj.id) newObj.id = Date.now();</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>arr.push(newObj);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>this.setOffertes(arr);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>}</span></p>
<p class="p1"><span class="s1">};</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">/* ---------- TABS ---------- */</span></p>
<p class="p1"><span class="s1">function switchTab(ev, id) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>document.querySelectorAll('.tab-content').forEach(t =&gt; t.classList.remove('active'));</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>document.querySelectorAll('.tabs button').forEach(b =&gt; b.classList.remove('active'));</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>document.getElementById(id).classList.add('active');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>if (ev &amp;&amp; ev.target) ev.target.classList.add('active');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>if (id === 'quote') renderQuote();</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>if (id === 'mgmt') renderMgmt();</span></p>
<p class="p1"><span class="s1">}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">/* ---------- CALCULATION ---------- */</span></p>
<p class="p1"><span class="s1">function bereken() {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>const vl <span class="Apple-converted-space">Â  </span>= parseFloat(document.getElementById('vlOppervl').value) || 0;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>const zv <span class="Apple-converted-space">Â  </span>= parseFloat(document.getElementById('zaagV').value) || 0;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>const vlTotaal = vl * (1 + zv / 100);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>document.getElementById('vlTotaal').value = vlTotaal.toFixed(2);</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>const vlPrijs <span class="Apple-converted-space">Â  </span>= parseFloat(document.getElementById('vlPrijs').value) || 0;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>const ondPrijs<span class="Apple-converted-space">Â  </span>= (document.getElementById('ondVereist').checked) ?</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>(parseFloat(document.getElementById('ondPrijs').value) || 0) : 0;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>const omtrek<span class="Apple-converted-space">Â  Â  </span>= parseFloat(document.getElementById('omtrek').value) || 0;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>const plintPrijs = parseFloat(document.getElementById('plintPrijs').value) || 0;</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>const materialTotal = getMaterialTotal();</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>const subMat = (vlTotaal * vlPrijs) + (vl * ondPrijs) + (omtrek * plintPrijs) + materialTotal;</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>const legen<span class="Apple-converted-space">Â  Â  Â  </span>= parseFloat(document.getElementById('leggen').value) || 0;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>const toeslag<span class="Apple-converted-space">Â  Â  </span>= parseFloat(document.getElementById('legToeslag').value) || 0;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>const egal <span class="Apple-converted-space">Â  Â  Â  </span>= parseFloat(document.getElementById('egal').value) || 0;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>const oud<span class="Apple-converted-space">Â  Â  Â  Â  </span>= parseFloat(document.getElementById('oudVloer').value) || 0;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>const vrij <span class="Apple-converted-space">Â  Â  Â  </span>= parseFloat(document.getElementById('vrijKosten').value) || 0;</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>const subArb = (vl * leggen) + (vl * toeslag) + (vl * egal) + (vl * oud) + vrij;</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>const netto = subMat + subArb;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>const btw <span class="Apple-converted-space">Â  </span>= netto * 0.21;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>const bruto = netto + btw;</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>document.getElementById('subMat').innerText <span class="Apple-converted-space">Â  </span>= subMat.toFixed(2);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>document.getElementById('subArb').innerText <span class="Apple-converted-space">Â  </span>= subArb.toFixed(2);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>document.getElementById('totNetto').innerText = netto.toFixed(2);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>document.getElementById('btw').innerText<span class="Apple-converted-space">Â  Â  Â  </span>= btw.toFixed(2);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>document.getElementById('totBruto').innerText = bruto.toFixed(2);</span></p>
<p class="p1"><span class="s1">}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">/* ---------- MATERIAL LOGIC ---------- */</span></p>
<p class="p1"><span class="s1">const materialOptions = ['Lijm','Egalisatie','Primer','Voegkitt','Schuurpapier','Anders'];</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">function addMaterialRow(data = {}) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>const container = document.getElementById('materialContainer');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>const row = document.createElement('div');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>row.className = 'material-row';</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>row.innerHTML = `</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>&lt;select class="matType"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>&lt;option value=""&gt;Kies...&lt;/option&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>${materialOptions.map(o =&gt; `&lt;option value="${o}" ${data.type === o ? 'selected' : ''}&gt;${o}&lt;/option&gt;`).join('')}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>&lt;/select&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>&lt;input type="text" class="matLeverancier" placeholder="Leverancier" value="${data.leverancier || ''}"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>&lt;input type="number" class="matAantal" placeholder="Aantal" step="0.01" value="${data.aantal || ''}"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>&lt;input type="text" class="matEenheid" placeholder="Eenheid" value="${data.eenheid || ''}"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>&lt;input type="text" class="matArtNr" placeholder="Art.nr." value="${data.artNr || ''}"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>&lt;input type="number" class="matPrijs" placeholder="Prijs/st" step="0.01" value="${data.prijs || ''}"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>&lt;button type="button" class="btn danger" onclick="removeMaterialRow(this)"&gt;Ã—&lt;/button&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>`;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>container.appendChild(row);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>row.querySelectorAll('input,select').forEach(el =&gt; el.addEventListener('input', bereken));</span></p>
<p class="p1"><span class="s1">}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">/* helper to remove a material row */</span></p>
<p class="p1"><span class="s1">function removeMaterialRow(btn) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>btn.parentElement.remove();</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>bereken();</span></p>
<p class="p1"><span class="s1">}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">function getMaterialTotal() {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>let total = 0;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>document.querySelectorAll('.material-row').forEach(row =&gt; {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>const aantal = parseFloat(row.querySelector('.matAantal').value) || 0;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>const prijs<span class="Apple-converted-space">Â  </span>= parseFloat(row.querySelector('.matPrijs').value)<span class="Apple-converted-space">Â  </span>|| 0;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>total += aantal * prijs;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>});</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>return total;</span></p>
<p class="p1"><span class="s1">}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">function getMaterialRowsArray() {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>const rows = [];</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>document.querySelectorAll('.material-row').forEach(row =&gt; {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>rows.push({</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>type:<span class="Apple-converted-space">Â  Â  Â  Â  </span>row.querySelector('.matType').value,</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>leverancier: row.querySelector('.matLeverancier').value,</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>aantal:<span class="Apple-converted-space">Â  Â  Â  </span>row.querySelector('.matAantal').value,</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>eenheid: <span class="Apple-converted-space">Â  Â  </span>row.querySelector('.matEenheid').value,</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>artNr: <span class="Apple-converted-space">Â  Â  Â  </span>row.querySelector('.matArtNr').value,</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>prijs: <span class="Apple-converted-space">Â  Â  Â  </span>row.querySelector('.matPrijs').value</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>});</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>});</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>return rows;</span></p>
<p class="p1"><span class="s1">}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">/* ---------- SAVE / EXPORT / RESET ---------- */</span></p>
<p class="p1"><span class="s1">function saveCalc() {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>const c = {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>projName:<span class="Apple-converted-space">Â  Â  </span>document.getElementById('projName').value,</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>custName:<span class="Apple-converted-space">Â  Â  </span>document.getElementById('custName').value,</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>projAdres: <span class="Apple-converted-space">Â  </span>document.getElementById('projAdres').value,</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>status:<span class="Apple-converted-space">Â  Â  Â  </span>document.getElementById('status').value,</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>vlOppervl: <span class="Apple-converted-space">Â  </span>document.getElementById('vlOppervl').value,</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>vlType:<span class="Apple-converted-space">Â  Â  Â  </span>document.getElementById('vlType').value,</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>vlProd:<span class="Apple-converted-space">Â  Â  Â  </span>document.getElementById('vlProd').value,</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>vlPrijs: <span class="Apple-converted-space">Â  Â  </span>document.getElementById('vlPrijs').value,</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>zaagV: <span class="Apple-converted-space">Â  Â  Â  </span>document.getElementById('zaagV').value,</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>vlTotaal:<span class="Apple-converted-space">Â  Â  </span>document.getElementById('vlTotaal').value,</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>ondVereist:<span class="Apple-converted-space">Â  </span>document.getElementById('ondVereist').checked,</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>ondKeuze:<span class="Apple-converted-space">Â  Â  </span>document.getElementById('ondKeuze').value,</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>ondPrijs:<span class="Apple-converted-space">Â  Â  </span>document.getElementById('ondPrijs').value,</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>omtrek:<span class="Apple-converted-space">Â  Â  Â  </span>document.getElementById('omtrek').value,</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>plintKeuze:<span class="Apple-converted-space">Â  </span>document.getElementById('plintKeuze').value,</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>plintPrijs:<span class="Apple-converted-space">Â  </span>document.getElementById('plintPrijs').value,</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>materialRows: getMaterialRowsArray(),</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>leggen:<span class="Apple-converted-space">Â  Â  Â  </span>document.getElementById('leggen').value,</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>legToeslag:<span class="Apple-converted-space">Â  </span>document.getElementById('legToeslag').value,</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>egal:<span class="Apple-converted-space">Â  Â  Â  Â  </span>document.getElementById('egal').value,</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>oudVloer:<span class="Apple-converted-space">Â  Â  </span>document.getElementById('oudVloer').value,</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>vrijKosten:<span class="Apple-converted-space">Â  </span>document.getElementById('vrijKosten').value,</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>vrijTekst: <span class="Apple-converted-space">Â  </span>document.getElementById('vrijTekst').value,</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>subMat:<span class="Apple-converted-space">Â  Â  Â  </span>document.getElementById('subMat').innerText,</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>subArb:<span class="Apple-converted-space">Â  Â  Â  </span>document.getElementById('subArb').innerText,</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>totNetto:<span class="Apple-converted-space">Â  Â  </span>document.getElementById('totNetto').innerText,</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>btw: <span class="Apple-converted-space">Â  Â  Â  Â  </span>document.getElementById('btw').innerText,</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>totBruto:<span class="Apple-converted-space">Â  Â  </span>document.getElementById('totBruto').innerText,</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>date:<span class="Apple-converted-space">Â  Â  Â  Â  </span>new Date().toISOString()</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>};</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>c.id = Date.now(); <span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  </span>// keep the id consistent</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>STORE.setCalc(c);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>STORE.addOfferte(c);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>switchTab({target:{}},'quote');</span></p>
<p class="p1"><span class="s1">}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">function exportCSV() {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>const c = STORE.getCalc();</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>if (!c.projName) { alert('Niets om te exporteren â€“ sla eerst op.'); return; }</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>let csv = 'Veld,Waarde\n';</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>for (const k in c) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>csv += `"${k}","${c[k]}"\n`;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>const blob = new Blob([csv], {type:'text/csv;charset=utf-8;'});</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>const a = document.createElement('a');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>a.href = URL.createObjectURL(blob);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>a.download = `calculatie_${c.projName.replace(/\s+/g,'_')}.csv`;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>a.click();</span></p>
<p class="p1"><span class="s1">}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">function resetForm() {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>document.querySelectorAll('#calc input, #calc select, #calc textarea')</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>.forEach(el =&gt; { if (el.type === 'checkbox') el.checked = false; else el.value = ''; });</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>document.getElementById('materialContainer').innerHTML = '';</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>addMaterialRow();</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>localStorage.removeItem('calc');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>bereken();</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>switchTab({target:{}},'calc');</span></p>
<p class="p1"><span class="s1">}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">/* ---------- QUOTE ---------- */</span></p>
<p class="p1"><span class="s1">function renderQuote() {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>const c = STORE.getCalc();</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>if (!c.projName) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>document.getElementById('quotePreview').innerHTML = '&lt;p&gt;Geen offerte beschikbaar.&lt;/p&gt;';</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>return;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>const logoB64 = ''; <span class="Apple-converted-space">Â  </span>// &lt;-- voeg hier eventueel een base64â€‘logo toe</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>const vloerOms = (c.vlType === 'Vloerbedekking') ? 'Vloerbedekking' : `${c.vlType} vloer`;</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>let materialRowsHtml = '';</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>if (c.materialRows &amp;&amp; c.materialRows.length) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>c.materialRows.forEach(r =&gt; {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>const aantal = parseFloat(r.aantal) || 0;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>const prijs<span class="Apple-converted-space">Â  </span>= parseFloat(r.prijs)<span class="Apple-converted-space">Â  </span>|| 0;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>const totaal = aantal * prijs;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>materialRowsHtml += `</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;tr&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;td&gt;${r.type} (${r.leverancier} - ${r.artNr})&lt;/td&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;td class="nr"&gt;${r.aantal} ${r.eenheid}&lt;/td&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;td class="nr"&gt;â‚¬ ${prijs.toFixed(2)}&lt;/td&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;td class="nr"&gt;â‚¬ ${totaal.toFixed(2)}&lt;/td&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;/tr&gt;`;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>});</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>const html = `</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>&lt;div class="print-header"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>&lt;img src="data:image/png;base64,${logoB64}" alt="Logo"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>&lt;div class="co-info"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;strong&gt;Next Generation Flooring&lt;/strong&gt;&lt;br&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>Josephine Bakerstraat 18&lt;br&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>1311 GA Almere&lt;br&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>Tel: +31 020 210 1184&lt;br&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>Eâ€‘mail: info@nextgenerationflooring.nl</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>&lt;/div&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>&lt;/div&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>&lt;div class="row"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>&lt;div class="col"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;h2&gt;Offerte ${c.projName}&lt;/h2&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;table class="meta"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;tr&gt;&lt;td&gt;Offertenummer:&lt;/td&gt;&lt;td&gt;NG-${c.id || '0000'}&lt;/td&gt;&lt;/tr&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;tr&gt;&lt;td&gt;Datum:&lt;/td&gt;&lt;td&gt;${new Date(c.date).toLocaleDateString('nl-NL')}&lt;/td&gt;&lt;/tr&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;tr&gt;&lt;td&gt;Klant:&lt;/td&gt;&lt;td&gt;${c.custName || ''}&lt;/td&gt;&lt;/tr&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;tr&gt;&lt;td&gt;Projectadres:&lt;/td&gt;&lt;td&gt;${c.projAdres || ''}&lt;/td&gt;&lt;/tr&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;tr&gt;&lt;td&gt;Geldigheid:&lt;/td&gt;&lt;td&gt;30 dagen&lt;/td&gt;&lt;/tr&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;/table&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>&lt;/div&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>&lt;div class="col"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;img class="preview-img" src="https://source.unsplash.com/900x600/?floor,${c.vlType}"</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>alt="${c.vlProd || 'Gekozen vloer'}"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>&lt;/div&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>&lt;/div&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>&lt;div class="row"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>&lt;div class="col"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;h3&gt;Prijsopbouw (â‚¬ incl. 21â€¯% BTW)&lt;/h3&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;table class="details"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;thead&gt;&lt;tr&gt;&lt;th&gt;Omschrijving&lt;/th&gt;&lt;th class="nr"&gt;aantal&lt;/th&gt;&lt;th class="nr"&gt;â‚¬ / eenh.&lt;/th&gt;&lt;th class="nr"&gt;bedrag&lt;/th&gt;&lt;/tr&gt;&lt;/thead&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;tbody&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;tr&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;td&gt;${vloerOms}&lt;/td&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;td class="nr"&gt;${c.vlTotaal} mÂ²&lt;/td&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;td class="nr"&gt;â‚¬ ${parseFloat(c.vlPrijs).toFixed(2)}&lt;/td&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;td class="nr"&gt;â‚¬ ${(parseFloat(c.vlTotaal) * parseFloat(c.vlPrijs)).toFixed(2)}&lt;/td&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;/tr&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>${c.ondVereist ? `</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;tr&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;td&gt;Ondervloer ${c.ondKeuze}&lt;/td&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;td class="nr"&gt;${c.vlOppervl} mÂ²&lt;/td&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;td class="nr"&gt;â‚¬ ${parseFloat(c.ondPrijs).toFixed(2)}&lt;/td&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;td class="nr"&gt;â‚¬ ${(parseFloat(c.vlOppervl) * parseFloat(c.ondPrijs)).toFixed(2)}&lt;/td&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;/tr&gt;` : ''}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;tr&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;td&gt;Plinten ${c.plintKeuze}&lt;/td&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;td class="nr"&gt;${c.omtrek} m&lt;/td&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;td class="nr"&gt;â‚¬ ${parseFloat(c.plintPrijs).toFixed(2)}&lt;/td&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;td class="nr"&gt;â‚¬ ${(parseFloat(c.omtrek) * parseFloat(c.plintPrijs)).toFixed(2)}&lt;/td&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;/tr&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>${materialRowsHtml}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;tr&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;td&gt;Arbeid &amp;amp; service&lt;/td&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;td class="nr"&gt;&lt;/td&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;td class="nr"&gt;&lt;/td&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;td class="nr"&gt;â‚¬ ${parseFloat(c.subArb).toFixed(2)}&lt;/td&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;/tr&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;tr class="tot"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;td&gt;&lt;strong&gt;Totaal incl. 21â€¯% BTW&lt;/strong&gt;&lt;/td&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;td class="nr"&gt;&lt;/td&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;td class="nr"&gt;&lt;/td&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;td class="nr"&gt;&lt;strong&gt;â‚¬ ${parseFloat(c.totBruto).toFixed(2)}&lt;/strong&gt;&lt;/td&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;/tr&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;/tbody&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;/table&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>&lt;/div&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>&lt;/div&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>&lt;div class="row"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>&lt;div class="col"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;h3&gt;Levering &amp;amp; garantie&lt;/h3&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;ul&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;li&gt;Levertijd: 5â€‘10 werkdagen na akkoord&lt;/li&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;li&gt;10â€¯jaar woonâ€‘garantie op de vloer&lt;/li&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;li&gt;2â€¯jaar garantie op gehele installatie&lt;/li&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;li&gt;Professionele legservice inbegrepen&lt;/li&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;/ul&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;p&gt;&lt;strong&gt;Opmerkingen:&lt;/strong&gt; ${c.vrijTekst || 'Geen bijzonderheden.'}&lt;/p&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>&lt;/div&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>&lt;/div&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>&lt;div class="row"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>&lt;div class="col"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;button class="btn success" onclick="alert('Bedankt â€“ u ontvangt binnen 1 uur een bevestiging per eâ€‘mail!')"&gt;Offerte digitaal ondertekenen&lt;/button&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;button class="btn secondary" onclick="window.print()"&gt;Download / print PDF&lt;/button&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>&lt;/div&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>&lt;/div&gt;`;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>document.getElementById('quotePreview').innerHTML = html;</span></p>
<p class="p1"><span class="s1">}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">/* ---------- MANAGEMENT ---------- */</span></p>
<p class="p1"><span class="s1">function renderMgmt() {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>const list = STORE.getOffertes();</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>const won<span class="Apple-converted-space">Â  Â  Â  Â  </span>= list.filter(o =&gt; o.status === 'Gewonnen');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>const verzonden<span class="Apple-converted-space">Â  </span>= list.filter(o =&gt; ['Verzonden','Aangepast','Gewonnen','Verloren'].includes(o.status));</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>const aov = won.length ? won.reduce((s,o) =&gt; s + parseFloat(o.totBruto), 0) / won.length : 0;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>const conv = verzonden.length ? (won.length / verzonden.length) * 100 : 0;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>const pipe = list.filter(o =&gt; ['Concept','Verzonden','Aangepast'].includes(o.status))</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>.reduce((s,o) =&gt; s + parseFloat(o.totBruto), 0);</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>document.querySelector('#kpiAOV span').innerText = aov.toFixed(0);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>document.querySelector('#kpiConv span').innerText = conv.toFixed(1);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>document.querySelector('#kpiPipe span').innerText = pipe.toFixed(0);</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>// pipeline chart (counts per status)</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>const pipelineData = {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>labels:['Concept','Verzonden','Aangepast','Gewonnen','Verloren'],</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>data:[</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>list.filter(o =&gt; o.status === 'Concept').length,</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>list.filter(o =&gt; o.status === 'Verzonden').length,</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>list.filter(o =&gt; o.status === 'Aangepast').length,</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>won.length,</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>list.filter(o =&gt; o.status === 'Verloren').length</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>]</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>};</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>drawBar('pipeChart', pipelineData);</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>// static lossâ€‘reasons pie chart</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>const lossLabels = ['Prijs te hoog','Levertijd','Product niet beschikbaar','Andere'];</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>const lossData <span class="Apple-converted-space">Â  </span>= [40,25,20,15];</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>drawPie('lossChart', lossLabels, lossData);</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>// omzet per vloerâ€‘type (only gewonnen offertes)</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>const omzetPerType = {};</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>list.forEach(o =&gt; {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>if (o.status === 'Gewonnen') {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>const type = o.vlType || 'Onbekend';</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>omzetPerType[type] = (omzetPerType[type] || 0) + parseFloat(o.totBruto);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>});</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>const prodChartData = {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>labels:Object.keys(omzetPerType),</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>data:Object.values(omzetPerType)</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>};</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>drawBar('prodChart', prodChartData);</span></p>
<p class="p1"><span class="s1">}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">/* ---------- CHARTS ---------- */</span></p>
<p class="p1"><span class="s1">function drawBar(canvasId, {labels, data}) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>const canvas = document.getElementById(canvasId);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>const ctx = canvas.getContext('2d');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>const pad = 30;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>const w = canvas.width = canvas.offsetWidth;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>const h = canvas.height = 160;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>const barSlot = (w - 2 * pad) / labels.length;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>const barW <span class="Apple-converted-space">Â  </span>= barSlot * 0.7;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>const gap<span class="Apple-converted-space">Â  Â  </span>= barSlot * 0.3;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>const maxVal = Math.max(...data, 1);</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>ctx.clearRect(0,0,w,h);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>labels.forEach((label,i) =&gt; {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>const val <span class="Apple-converted-space">Â  </span>= data[i];</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>const barH<span class="Apple-converted-space">Â  </span>= (val / maxVal) * (h - 2 * pad);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>const x = pad + i * barSlot + gap / 2;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>const y = h - pad - barH;</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>ctx.fillStyle = '#0d47a1';</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>ctx.fillRect(x, y, barW, barH);</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>ctx.fillStyle = '#000';</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>ctx.font = '12px sans-serif';</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>ctx.textAlign = 'center';</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>ctx.fillText(val, x + barW/2, y - 4);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>ctx.fillText(label, x + barW/2, h - pad + 14);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>});</span></p>
<p class="p1"><span class="s1">}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">function drawPie(canvasId, labels, data) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>const canvas = document.getElementById(canvasId);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>const ctx = canvas.getContext('2d');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>const w = canvas.width = canvas.offsetWidth;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>const h = canvas.height = 160;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>const R = Math.min(w,h) / 2 - 20;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>const total = data.reduce((a,b) =&gt; a + b, 0);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>const colors = ['#c62828','#ff6f00','#2e7d32','#0277bd','#9c27b0','#ff9800'];</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>ctx.clearRect(0,0,w,h);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>let start = 0;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>data.forEach((value,i) =&gt; {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>const angle = (value / total) * 2 * Math.PI;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>ctx.beginPath();</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>ctx.moveTo(w/2, h/2);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>ctx.arc(w/2, h/2, R, start, start + angle);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>ctx.closePath();</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>ctx.fillStyle = colors[i % colors.length];</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>ctx.fill();</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>start += angle;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>});</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>// simple legend (optional)</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>const legendX = w - 100;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>let legendY = 20;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>ctx.font = '12px sans-serif';</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>labels.forEach((lab,i) =&gt; {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>ctx.fillStyle = colors[i % colors.length];</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>ctx.fillRect(legendX, legendY - 12, 12, 12);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>ctx.fillStyle = '#000';</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>ctx.fillText(`${lab} (${data[i]})`, legendX + 16, legendY);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>legendY += 20;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>});</span></p>
<p class="p1"><span class="s1">}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">/* ---------- DEMO DATA (RESET) ---------- */</span></p>
<p class="p1"><span class="s1">function resetData() {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>// clear stored data</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>localStorage.removeItem('calc');</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>localStorage.removeItem('offertes');</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>// create a few demo offers</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>const demo = [</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>{</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>projName:<span class="Apple-converted-space">Â  Â  </span>'Demo Project 1',</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>custName:<span class="Apple-converted-space">Â  Â  </span>'Demo Klant',</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>projAdres: <span class="Apple-converted-space">Â  </span>'Straat 1, 1234 AB Demo',</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>status:<span class="Apple-converted-space">Â  Â  Â  </span>'Gewonnen',</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>vlOppervl: <span class="Apple-converted-space">Â  </span>'30',</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>vlType:<span class="Apple-converted-space">Â  Â  Â  </span>'PVC',</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>vlProd:<span class="Apple-converted-space">Â  Â  Â  </span>'Demo Vloer',</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>vlPrijs: <span class="Apple-converted-space">Â  Â  </span>'25',</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>zaagV: <span class="Apple-converted-space">Â  Â  Â  </span>'5',</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>vlTotaal:<span class="Apple-converted-space">Â  Â  </span>(30 * 1.05).toFixed(2),</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>ondVereist:<span class="Apple-converted-space">Â  </span>true,</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>ondKeuze:<span class="Apple-converted-space">Â  Â  </span>'Beton',</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>ondPrijs:<span class="Apple-converted-space">Â  Â  </span>'5',</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>omtrek:<span class="Apple-converted-space">Â  Â  Â  </span>'12',</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>plintKeuze:<span class="Apple-converted-space">Â  </span>'Eiken',</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>plintPrijs:<span class="Apple-converted-space">Â  </span>'3',</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>materialRows:[],</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>leggen:<span class="Apple-converted-space">Â  Â  Â  </span>'15',</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>legToeslag:<span class="Apple-converted-space">Â  </span>'0',</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>egal:<span class="Apple-converted-space">Â  Â  Â  Â  </span>'5',</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>oudVloer:<span class="Apple-converted-space">Â  Â  </span>'0',</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>vrijKosten:<span class="Apple-converted-space">Â  </span>'50',</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>vrijTekst: <span class="Apple-converted-space">Â  </span>'',</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>subMat:<span class="Apple-converted-space">Â  Â  Â  </span>'',</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>subArb:<span class="Apple-converted-space">Â  Â  Â  </span>'',</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>totNetto:<span class="Apple-converted-space">Â  Â  </span>'',</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>btw: <span class="Apple-converted-space">Â  Â  Â  Â  </span>'',</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>totBruto:<span class="Apple-converted-space">Â  Â  </span>'',</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>date:<span class="Apple-converted-space">Â  Â  Â  Â  </span>new Date().toISOString()</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>},</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>{</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>projName:<span class="Apple-converted-space">Â  Â  </span>'Demo Project 2',</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>custName:<span class="Apple-converted-space">Â  Â  </span>'Klant B',</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>projAdres: <span class="Apple-converted-space">Â  </span>'Straat 2, 5678 CD Demo',</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>status:<span class="Apple-converted-space">Â  Â  Â  </span>'Concept',</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>vlOppervl: <span class="Apple-converted-space">Â  </span>'45',</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>vlType:<span class="Apple-converted-space">Â  Â  Â  </span>'Laminaat',</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>vlProd:<span class="Apple-converted-space">Â  Â  Â  </span>'Voorbeeld Laminaat',</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>vlPrijs: <span class="Apple-converted-space">Â  Â  </span>'20',</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>zaagV: <span class="Apple-converted-space">Â  Â  Â  </span>'5',</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>vlTotaal:<span class="Apple-converted-space">Â  Â  </span>(45 * 1.05).toFixed(2),</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>ondVereist:<span class="Apple-converted-space">Â  </span>false,</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>ondKeuze:<span class="Apple-converted-space">Â  Â  </span>'',</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>ondPrijs:<span class="Apple-converted-space">Â  Â  </span>'',</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>omtrek:<span class="Apple-converted-space">Â  Â  Â  </span>'15',</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>plintKeuze:<span class="Apple-converted-space">Â  </span>'Geen',</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>plintPrijs:<span class="Apple-converted-space">Â  </span>'0',</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>materialRows:[],</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>leggen:<span class="Apple-converted-space">Â  Â  Â  </span>'12',</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>legToeslag:<span class="Apple-converted-space">Â  </span>'0',</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>egal:<span class="Apple-converted-space">Â  Â  Â  Â  </span>'4',</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>oudVloer:<span class="Apple-converted-space">Â  Â  </span>'2',</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>vrijKosten:<span class="Apple-converted-space">Â  </span>'30',</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>vrijTekst: <span class="Apple-converted-space">Â  </span>'',</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>subMat:<span class="Apple-converted-space">Â  Â  Â  </span>'',</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>subArb:<span class="Apple-converted-space">Â  Â  Â  </span>'',</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>totNetto:<span class="Apple-converted-space">Â  Â  </span>'',</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>btw: <span class="Apple-converted-space">Â  Â  Â  Â  </span>'',</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>totBruto:<span class="Apple-converted-space">Â  Â  </span>'',</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>date:<span class="Apple-converted-space">Â  Â  Â  Â  </span>new Date().toISOString()</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>];</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>// calculate totals for demo offers</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>demo.forEach(o =&gt; {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>const vl = parseFloat(o.vlOppervl);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>const zv = parseFloat(o.zaagV);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>const vt = vl * (1 + zv/100);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>const subMat = (vt * parseFloat(o.vlPrijs)) +</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>(vl * (o.ondVereist ? parseFloat(o.ondPrijs) : 0)) +</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>(parseFloat(o.omtrek) * parseFloat(o.plintPrijs));</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>const subArb = (vl * parseFloat(o.leggen)) +</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>(vl * parseFloat(o.legToeslag)) +</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>(vl * parseFloat(o.egal)) +</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>(vl * parseFloat(o.oudVloer)) +</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  </span>parseFloat(o.vrijKosten);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>const netto = subMat + subArb;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>const btw <span class="Apple-converted-space">Â  </span>= netto * 0.21;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>const bruto = netto + btw;</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>o.subMat <span class="Apple-converted-space">Â  </span>= subMat.toFixed(2);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>o.subArb <span class="Apple-converted-space">Â  </span>= subArb.toFixed(2);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>o.totNetto = netto.toFixed(2);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>o.btw<span class="Apple-converted-space">Â  Â  Â  </span>= btw.toFixed(2);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>o.totBruto = bruto.toFixed(2);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>});</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>STORE.setOffertes(demo);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>// after resetting, show the management dashboard</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>switchTab({target:{}},'mgmt');</span></p>
<p class="p1"><span class="s1">}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">/* ---------- START ---------- */</span></p>
<p class="p1"><span class="s1">(function(){</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>addMaterialRow(); // start with one empty material row</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>const saved = STORE.getCalc();</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>if (saved.projName) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>if (saved.materialRows &amp;&amp; saved.materialRows.length) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>document.getElementById('materialContainer').innerHTML = '';</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>saved.materialRows.forEach(r =&gt; addMaterialRow(r));</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>Object.keys(saved).forEach(k =&gt; {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>const el = document.getElementById(k);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>if (el) {</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>if (el.type === 'checkbox') el.checked = saved[k];</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>else el.value = saved[k];</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>});</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>bereken();</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>}</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>if (!STORE.getOffertes().length) resetData();</span></p>
<p class="p1"><span class="s1">})();</span></p>
<p class="p1"><span class="s1">&lt;/script&gt;</span></p>
<p class="p1"><span class="s1">&lt;/body&gt;</span></p>
<p class="p1"><span class="s1">&lt;/html&gt;</span></p>
</body>
</html>
