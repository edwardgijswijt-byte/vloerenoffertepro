<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html>
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8">
  <meta http-equiv="Content-Style-Type" content="text/css">
  <title></title>
  <meta name="Generator" content="Cocoa HTML Writer">
  <meta name="CocoaVersion" content="2575.7">
  <style type="text/css">
    body {background-color: #f2f5f9}
    p.p1 {margin: 0.0px 0.0px 0.0px 0.0px; font: 14.0px Menlo; color: #2a2c33; background-color: #ffffff}
    p.p2 {margin: 0.0px 0.0px 0.0px 0.0px; font: 14.0px Menlo; color: #2a2c33; background-color: #ffffff; min-height: 16.0px}
    p.p3 {margin: 0.0px 0.0px 0.0px 0.0px; font: 14.0px 'Helvetica Neue'; color: #000000; color: rgba(0, 0, 0, 0.9); min-height: 16.0px}
    p.p4 {margin: 0.0px 0.0px 0.0px 0.0px; font: 16.0px 'Helvetica Neue'; color: #000000; color: rgba(0, 0, 0, 0.9)}
    p.p5 {margin: 0.0px 0.0px 0.0px 0.0px; font: 16.0px 'Helvetica Neue'; color: #000000; color: rgba(0, 0, 0, 0.9); background-color: #ffffff}
    p.p6 {margin: 0.0px 0.0px 0.0px 0.0px; font: 16.0px 'Helvetica Neue'; color: #000000; color: rgba(0, 0, 0, 0.9); background-color: #ffffff; min-height: 18.0px}
    p.p7 {margin: 0.0px 0.0px 0.0px 0.0px; font: 12.0px 'Helvetica Neue'; color: #000000; color: rgba(0, 0, 0, 0.6); min-height: 14.0px}
    p.p8 {margin: 0.0px 0.0px 0.0px 0.0px; font: 12.0px 'Helvetica Neue'; color: #000000; color: rgba(0, 0, 0, 0.6)}
    p.p9 {margin: 0.0px 0.0px 0.0px 0.0px; font: 12.0px 'Helvetica Neue'; color: #000000; color: rgba(0, 0, 0, 0.9); background-color: #000000; background-color: rgba(0, 0, 0, 0.13); min-height: 14.0px}
    p.p10 {margin: 0.0px 0.0px 0.0px 0.0px; font: 16.0px 'Helvetica Neue'; color: #000000; color: rgba(0, 0, 0, 0.9); background-color: #000000; background-color: rgba(0, 0, 0, 0.031)}
    p.p11 {margin: 0.0px 0.0px 0.0px 0.0px; font: 14.0px 'Times New Roman'; color: #000000; color: rgba(0, 0, 0, 0.9); min-height: 16.0px}
    p.p12 {margin: 0.0px 0.0px 0.0px 0.0px; font: 14.0px 'Helvetica Neue'; color: #000000; color: rgba(0, 0, 0, 0.6); min-height: 16.0px}
    p.p13 {margin: 0.0px 0.0px 0.0px 0.0px; font: 14.0px 'Helvetica Neue'; color: #000000; color: rgba(0, 0, 0, 0.6)}
    span.s1 {font-kerning: none}
    span.s2 {font: 14.0px 'Apple Color Emoji'; font-kerning: none}
    span.s3 {font-kerning: none; background-color: #ffffff}
    span.s4 {font-kerning: none; background-color: rgba(0, 0, 0, 0.031)}
    span.s5 {font-kerning: none; background-color: #f2f2f2}
  </style>
</head>
<body>
<p class="p1"><span class="s1">&lt;h1&gt;5. Arbeid &amp; Service&lt;/h1&gt;</span></p>
<p class="p1"><span class="s1">&lt;div class="row"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>&lt;div class="col"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>&lt;label&gt;Leggen vloer (â‚¬/mÂ²)&lt;/label&gt;&lt;input id="leggen" type="number" step="0.01" oninput="bereken()"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>&lt;label&gt;Leggen toeslag (â‚¬/mÂ² of %)&lt;/label&gt;&lt;input id="legToeslag" type="number" step="0.01" placeholder="0" oninput="bereken()"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>&lt;label&gt;Egaliseren (â‚¬/mÂ²)&lt;/label&gt;&lt;input id="egal" type="number" step="0.01" oninput="bereken()"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>&lt;label&gt;Oude vloer verwijderen (â‚¬/mÂ²)&lt;/label&gt;&lt;input id="oudVloer" type="number" step="0.01" oninput="bereken()"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>&lt;label&gt;Voorrijkosten / transport â‚¬&lt;/label&gt;&lt;input id="vrijKosten" type="number" step="0.01" oninput="bereken()"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>&lt;label&gt;Vrij tekst (condities)&lt;/label&gt;&lt;textarea id="vrijTekst" rows="3" placeholder="Niet inbegrepen: verwijdering meubels..."&gt;&lt;/textarea&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>&lt;/div&gt;</span></p>
<p class="p1"><span class="s1">&lt;/div&gt;</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">&lt;h1&gt;6. Finale Prijscalculatie&lt;/h1&gt;</span></p>
<p class="p1"><span class="s1">&lt;div class="row"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>&lt;div class="col"&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>&lt;table&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>&lt;tr&gt;&lt;th&gt;Post&lt;/th&gt;&lt;th&gt;Bedrag (â‚¬ excl.)&lt;/th&gt;&lt;/tr&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>&lt;tr&gt;&lt;td&gt;Subtotaal Materialen&lt;/td&gt;&lt;td id="subMat"&gt;0.00&lt;/td&gt;&lt;/tr&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>&lt;tr&gt;&lt;td&gt;Subtotaal Arbeid&lt;/td&gt;&lt;td id="subArb"&gt;0.00&lt;/td&gt;&lt;/tr&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>&lt;tr&gt;&lt;td&gt;Totaal Netto&lt;/td&gt;&lt;td id="totNetto"&gt;0.00&lt;/td&gt;&lt;/tr&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>&lt;tr&gt;&lt;td&gt;BTW 21%&lt;/td&gt;&lt;td id="btw"&gt;0.00&lt;/td&gt;&lt;/tr&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>&lt;tr&gt;&lt;td&gt;&lt;strong&gt;Totaal Offerteprijs (Bruto)&lt;/strong&gt;&lt;/td&gt;&lt;td id="totBruto"&gt;&lt;strong&gt;0.00&lt;/strong&gt;&lt;/td&gt;&lt;/tr&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>&lt;/table&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>&lt;button class="btn success" onclick="saveCalc()"&gt;Opslaan &amp; Offerte Tonen&lt;/button&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>&lt;button type="button" class="btn danger" onclick="resetForm()"&gt;</span><span class="s2">ðŸ—‘</span><span class="s1"> Nieuw formulier&lt;/button&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>&lt;button class="btn secondary" onclick="exportCSV()"&gt;Export CSV&lt;/button&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>&lt;/div&gt;</span></p>
<p class="p1"><span class="s1">&lt;/div&gt;</span></p>
<p class="p3"><span class="s1"></span><br></p>
<p class="p4"><span class="s3">&lt;/div&gt;</span></p>
<p class="p4"><span class="s3">&lt;!-- ========================== OFFERTE ========================== --&gt;</span></p>
<p class="p5"><span class="s1">&lt;div id="quote" class="tab-content"&gt;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>&lt;div id="quotePreview"&gt;&lt;/div&gt;</span></p>
<p class="p4"><span class="s3">&lt;/div&gt;</span></p>
<p class="p4"><span class="s3">&lt;!-- ========================== MANAGEMENT ======================= --&gt;</span></p>
<p class="p5"><span class="s1">&lt;div id="mgmt" class="tab-content"&gt;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>&lt;h1&gt;Management Dashboard&lt;/h1&gt;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>&lt;div class="row"&gt;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>&lt;div class="col"&gt;&lt;div class="kpi" id="kpiAOV"&gt;Gem. Orderwaarde&lt;br/&gt;â‚¬ &lt;span&gt;0&lt;/span&gt;&lt;/div&gt;&lt;/div&gt;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>&lt;div class="col"&gt;&lt;div class="kpi" id="kpiConv"&gt;Conversie&lt;br/&gt;&lt;span&gt;0&lt;/span&gt; %&lt;/div&gt;&lt;/div&gt;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>&lt;div class="col"&gt;&lt;div class="kpi" id="kpiPipe"&gt;Pipeline&lt;br/&gt;â‚¬ &lt;span&gt;0&lt;/span&gt;&lt;/div&gt;&lt;/div&gt;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>&lt;/div&gt;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>&lt;h2&gt;Offerte-Pijplijn&lt;/h2&gt;&lt;canvas id="pipeChart" height="120"&gt;&lt;/canvas&gt;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>&lt;h2&gt;Redenen Verloren&lt;/h2&gt;&lt;canvas id="lossChart" height="120"&gt;&lt;/canvas&gt;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>&lt;h2&gt;Performance per Productgroep&lt;/h2&gt;&lt;canvas id="prodChart" height="120"&gt;&lt;/canvas&gt;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>&lt;button class="btn" onclick="resetData()"&gt;Reset demo data&lt;/button&gt;</span></p>
<p class="p4"><span class="s3">&lt;/div&gt;</span></p>
<p class="p5"><span class="s1">&lt;script&gt;</span></p>
<p class="p5"><span class="s1">/* ----------<span class="Apple-converted-space">Â  </span>GLOBAL STORE<span class="Apple-converted-space">Â  </span>---------- */</span></p>
<p class="p5"><span class="s1">const STORE = {</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>calc(){ return JSON.parse(localStorage.getItem('calc')||'{}'); },</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>setCalc(obj){ localStorage.setItem('calc',JSON.stringify(obj)); },</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>offertes(){ return JSON.parse(localStorage.getItem('offertes')||'[]'); },</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>addOfferte(o){ const arr = STORE.offertes(); arr.push({...o, id:Date.now()}); localStorage.setItem('offertes',JSON.stringify(arr)); }</span></p>
<p class="p5"><span class="s1">};</span></p>
<p class="p6"><span class="s1"></span><br></p>
<p class="p5"><span class="s1">/* ----------<span class="Apple-converted-space">Â  </span>TABS<span class="Apple-converted-space">Â  </span>---------- */</span></p>
<p class="p5"><span class="s1">function switchTab(ev,id){</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>document.querySelectorAll('.tab-content').forEach(t=&gt;t.classList.remove('active'));</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>document.querySelectorAll('.tabs button').forEach(b=&gt;b.classList.remove('active'));</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>document.getElementById(id).classList.add('active');</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>if(ev &amp;&amp; ev.target) ev.target.classList.add('active');</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>if(id==='quote') renderQuote();</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>if(id==='mgmt') renderMgmt();</span></p>
<p class="p5"><span class="s1">}</span></p>
<p class="p6"><span class="s1"></span><br></p>
<p class="p5"><span class="s1">/* ----------<span class="Apple-converted-space">Â  </span>CALC<span class="Apple-converted-space">Â  </span>---------- */</span></p>
<p class="p5"><span class="s1">function bereken(){</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>const vl <span class="Apple-converted-space">Â  </span>= parseFloat(document.getElementById('vlOppervl').value)||0;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>const zv <span class="Apple-converted-space">Â  </span>= parseFloat(document.getElementById('zaagV').value)||0;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>const vlTotaal = vl*(1+zv/100);</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>document.getElementById('vlTotaal').value = vlTotaal.toFixed(2);</span></p>
<p class="p6"><span class="s1"></span><br></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>const vlPrijs<span class="Apple-converted-space">Â  Â  </span>= parseFloat(document.getElementById('vlPrijs').value)||0;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>const ondPrijs <span class="Apple-converted-space">Â  </span>= (document.getElementById('ondVereist').checked ? parseFloat(document.getElementById('ondPrijs').value)||0 : 0);</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>const omtrek <span class="Apple-converted-space">Â  Â  </span>= parseFloat(document.getElementById('omtrek').value)||0;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>const plintPrijs = parseFloat(document.getElementById('plintPrijs').value)||0;</span></p>
<p class="p6"><span class="s1"></span><br></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>/* overige materialen optellen */</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>const materialTotal = getMaterialTotal();</span></p>
<p class="p6"><span class="s1"></span><br></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>const subMat <span class="Apple-converted-space">Â  Â  </span>= vlTotaal*vlPrijs + vl*ondPrijs + omtrek*plintPrijs + materialTotal;</span></p>
<p class="p6"><span class="s1"></span><br></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>const leg <span class="Apple-converted-space">Â  Â  </span>= parseFloat(document.getElementById('leggen').value)||0;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>const toeslag = parseFloat(document.getElementById('legToeslag').value)||0;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>const egal<span class="Apple-converted-space">Â  Â  </span>= parseFloat(document.getElementById('egal').value)||0;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>const oud <span class="Apple-converted-space">Â  Â  </span>= parseFloat(document.getElementById('oudVloer').value)||0;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>const vri <span class="Apple-converted-space">Â  Â  </span>= parseFloat(document.getElementById('vrijKosten').value)||0;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>const subArb<span class="Apple-converted-space">Â  </span>= vl*leg + vl*toeslag + vl*egal + vl*oud + vri;</span></p>
<p class="p6"><span class="s1"></span><br></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>const netto = subMat + subArb;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>const btw <span class="Apple-converted-space">Â  </span>= netto * 0.21;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>const bruto = netto + btw;</span></p>
<p class="p6"><span class="s1"></span><br></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>document.getElementById('subMat').innerText <span class="Apple-converted-space">Â  </span>= subMat.toFixed(2);</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>document.getElementById('subArb').innerText <span class="Apple-converted-space">Â  </span>= subArb.toFixed(2);</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>document.getElementById('totNetto').innerText = netto.toFixed(2);</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>document.getElementById('btw').innerText<span class="Apple-converted-space">Â  Â  Â  </span>= btw.toFixed(2);</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>document.getElementById('totBruto').innerText = bruto.toFixed(2);</span></p>
<p class="p5"><span class="s1">}</span></p>
<p class="p6"><span class="s1"></span><br></p>
<p class="p5"><span class="s1">/* ----------<span class="Apple-converted-space">Â  </span>MATERIAAL-LOGICA<span class="Apple-converted-space">Â  </span>---------- */</span></p>
<p class="p5"><span class="s1">const materialOptions = ['Lijm','Egalisatie','Primer','Voegkitt','Schuurpapier','Anders'];</span></p>
<p class="p6"><span class="s1"></span><br></p>
<p class="p5"><span class="s1">function addMaterialRow(data={}){</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>const container = document.getElementById('materialContainer');</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>const row = document.createElement('div');</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>row.className = 'material-row';</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>row.innerHTML = `</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>&lt;select class="matType"&gt;&lt;option value=""&gt;Kies...&lt;/option&gt;${materialOptions.map(o=&gt;`&lt;option ${data.type===o?'selected':''}&gt;${o}&lt;/option&gt;`).join('')}&lt;/select&gt;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>&lt;input type="text" <span class="Apple-converted-space">Â  </span>class="matLeverancier" placeholder="Leverancier" value="${data.leverancier||''}"&gt;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>&lt;input type="number" class="matAantal"<span class="Apple-converted-space">Â  Â  Â  </span>placeholder="Aantal"<span class="Apple-converted-space">Â  Â  Â  </span>value="${data.aantal||''}" step="0.01"&gt;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>&lt;input type="text" <span class="Apple-converted-space">Â  </span>class="matEenheid" <span class="Apple-converted-space">Â  Â  </span>placeholder="Eenheid" <span class="Apple-converted-space">Â  Â  </span>value="${data.eenheid||''}"&gt;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>&lt;input type="text" <span class="Apple-converted-space">Â  </span>class="matArtNr" <span class="Apple-converted-space">Â  Â  Â  </span>placeholder="Art.nr." <span class="Apple-converted-space">Â  Â  </span>value="${data.artNr||''}"&gt;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>&lt;input type="number" class="matPrijs" <span class="Apple-converted-space">Â  Â  Â  </span>placeholder="Prijs/st"<span class="Apple-converted-space">Â  Â  </span>value="${data.prijs||''}" step="0.01"&gt;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>&lt;button type="button" class="btn danger" onclick="this.parentElement.remove();bereken()"&gt;Ã—&lt;/button&gt;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>`;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>container.appendChild(row);</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>// auto-bereken bij wijziging</span></p>
<p class="p4"><span class="s3"><span class="Apple-converted-space">Â  Â  </span>row.querySelectorAll('input,select').forEach</span></p>
<p class="p7"><span class="s1"></span><br></p>
<p class="p8"><span class="s3">Copy</span></p>
<p class="p7"><span class="s1"></span><br></p>
<p class="p8"><span class="s3">Share</span></p>
<p class="p9"><span class="s1"></span><br></p>
<p class="p7"><span class="s1"></span><br></p>
<p class="p7"><span class="s1"></span><br></p>
<p class="p3"><span class="s1"></span><br></p>
<p class="p5"><span class="s1">(el=&gt;el.oninput=bereken);</span></p>
<p class="p5"><span class="s1">}</span></p>
<p class="p5"><span class="s1">function getMaterialTotal(){</span></p>
<p class="p5"><span class="s1">let tot = 0;</span></p>
<p class="p5"><span class="s1">document.querySelectorAll('.material-row').forEach(row=&gt;{</span></p>
<p class="p5"><span class="s1">const aantal = parseFloat(row.querySelector('.matAantal').value)||0;</span></p>
<p class="p5"><span class="s1">const prijs<span class="Apple-converted-space">Â  </span>= parseFloat(row.querySelector('.matPrijs').value)||0;</span></p>
<p class="p5"><span class="s1">tot += aantal * prijs;</span></p>
<p class="p5"><span class="s1">});</span></p>
<p class="p5"><span class="s1">return tot;</span></p>
<p class="p5"><span class="s1">}</span></p>
<p class="p5"><span class="s1">function getMaterialRowsArray(){</span></p>
<p class="p5"><span class="s1">const rows=[];</span></p>
<p class="p5"><span class="s1">document.querySelectorAll('.material-row').forEach(row=&gt;{</span></p>
<p class="p5"><span class="s1">rows.push({</span></p>
<p class="p5"><span class="s1">type: <span class="Apple-converted-space">Â  Â  Â  </span>row.querySelector('.matType').value,</span></p>
<p class="p5"><span class="s1">leverancier:row.querySelector('.matLeverancier').value,</span></p>
<p class="p5"><span class="s1">aantal: <span class="Apple-converted-space">Â  Â  </span>row.querySelector('.matAantal').value,</span></p>
<p class="p5"><span class="s1">eenheid:<span class="Apple-converted-space">Â  Â  </span>row.querySelector('.matEenheid').value,</span></p>
<p class="p5"><span class="s1">artNr:<span class="Apple-converted-space">Â  Â  Â  </span>row.querySelector('.matArtNr').value,</span></p>
<p class="p5"><span class="s1">prijs:<span class="Apple-converted-space">Â  Â  Â  </span>row.querySelector('.matPrijs').value</span></p>
<p class="p5"><span class="s1">});</span></p>
<p class="p5"><span class="s1">});</span></p>
<p class="p5"><span class="s1">return rows;</span></p>
<p class="p4"><span class="s3">}</span></p>
<p class="p5"><span class="s1">/* ----------<span class="Apple-converted-space">Â  </span>SAVE / EXPORT / RESET<span class="Apple-converted-space">Â  </span>---------- */</span></p>
<p class="p5"><span class="s1">function saveCalc(){</span></p>
<p class="p5"><span class="s1">const c = {</span></p>
<p class="p5"><span class="s1">projName:<span class="Apple-converted-space">Â  </span>document.getElementById('projName').value,</span></p>
<p class="p5"><span class="s1">custName:<span class="Apple-converted-space">Â  </span>document.getElementById('custName').value,</span></p>
<p class="p5"><span class="s1">projAdres: document.getElementById('projAdres').value,</span></p>
<p class="p5"><span class="s1">status:<span class="Apple-converted-space">Â  Â  </span>document.getElementById('status').value,</span></p>
<p class="p5"><span class="s1">vlOppervl: document.getElementById('vlOppervl').value,</span></p>
<p class="p5"><span class="s1">vlType:<span class="Apple-converted-space">Â  Â  </span>document.getElementById('vlType').value,</span></p>
<p class="p5"><span class="s1">vlProd:<span class="Apple-converted-space">Â  Â  </span>document.getElementById('vlProd').value,</span></p>
<p class="p5"><span class="s1">vlPrijs: <span class="Apple-converted-space">Â  </span>document.getElementById('vlPrijs').value,</span></p>
<p class="p5"><span class="s1">zaagV: <span class="Apple-converted-space">Â  Â  </span>document.getElementById('zaagV').value,</span></p>
<p class="p5"><span class="s1">vlTotaal:<span class="Apple-converted-space">Â  </span>document.getElementById('vlTotaal').value,</span></p>
<p class="p5"><span class="s1">ondVereist:document.getElementById('ondVereist').checked,</span></p>
<p class="p5"><span class="s1">ondKeuze:<span class="Apple-converted-space">Â  </span>document.getElementById('ondKeuze').value,</span></p>
<p class="p5"><span class="s1">ondPrijs:<span class="Apple-converted-space">Â  </span>document.getElementById('ondPrijs').value,</span></p>
<p class="p5"><span class="s1">omtrek:<span class="Apple-converted-space">Â  Â  </span>document.getElementById('omtrek').value,</span></p>
<p class="p5"><span class="s1">plintKeuze:document.getElementById('plintKeuze').value,</span></p>
<p class="p5"><span class="s1">plintPrijs:document.getElementById('plintPrijs').value,</span></p>
<p class="p5"><span class="s1">materialRows:getMaterialRowsArray(),</span></p>
<p class="p5"><span class="s1">leggen:<span class="Apple-converted-space">Â  Â  </span>document.getElementById('leggen').value,</span></p>
<p class="p5"><span class="s1">legToeslag:document.getElementById('legToeslag').value,</span></p>
<p class="p5"><span class="s1">egal:<span class="Apple-converted-space">Â  Â  Â  </span>document.getElementById('egal').value,</span></p>
<p class="p5"><span class="s1">oudVloer:<span class="Apple-converted-space">Â  </span>document.getElementById('oudVloer').value,</span></p>
<p class="p5"><span class="s1">vrijKosten:document.getElementById('vrijKosten').value,</span></p>
<p class="p5"><span class="s1">vrijTekst: document.getElementById('vrijTekst').value,</span></p>
<p class="p5"><span class="s1">subMat:<span class="Apple-converted-space">Â  Â  </span>document.getElementById('subMat').innerText,</span></p>
<p class="p5"><span class="s1">subArb:<span class="Apple-converted-space">Â  Â  </span>document.getElementById('subArb').innerText,</span></p>
<p class="p5"><span class="s1">totNetto:<span class="Apple-converted-space">Â  </span>document.getElementById('totNetto').innerText,</span></p>
<p class="p5"><span class="s1">btw: <span class="Apple-converted-space">Â  Â  Â  </span>document.getElementById('btw').innerText,</span></p>
<p class="p5"><span class="s1">totBruto:<span class="Apple-converted-space">Â  </span>document.getElementById('totBruto').innerText,</span></p>
<p class="p5"><span class="s1">date:<span class="Apple-converted-space">Â  Â  Â  </span>new Date().toISOString()</span></p>
<p class="p5"><span class="s1">};</span></p>
<p class="p5"><span class="s1">STORE.setCalc(c);</span></p>
<p class="p5"><span class="s1">STORE.addOfferte(c);</span></p>
<p class="p5"><span class="s1">switchTab({target:{}},'quote');</span></p>
<p class="p5"><span class="s1">}</span></p>
<p class="p5"><span class="s1">function exportCSV(){</span></p>
<p class="p5"><span class="s1">const c = STORE.calc();</span></p>
<p class="p5"><span class="s1">if(!c.projName){ alert('Niets om te exporteren â€“ sla eerst op.'); return;}</span></p>
<p class="p10"><span class="s3">let csv = </span><span class="s1">Veld,Waarde\n</span><span class="s3">;</span></p>
<p class="p5"><span class="s1">for(let k in c){ csv += </span><span class="s4">${k},"${c[k]}"\n</span><span class="s1">; }</span></p>
<p class="p5"><span class="s1">const blob = new Blob([csv],{type:'text/csv;charset=utf-8;'});</span></p>
<p class="p5"><span class="s1">const a = document.createElement('a'); a.href = URL.createObjectURL(blob);</span></p>
<p class="p10"><span class="s3">a.download = </span><span class="s1">calculatie_${c.projName.replace(/\s+/g,'_')}.csv</span><span class="s3">;</span></p>
<p class="p5"><span class="s1">a.click();</span></p>
<p class="p5"><span class="s1">}</span></p>
<p class="p5"><span class="s1">function resetForm(){</span></p>
<p class="p5"><span class="s1">document.querySelectorAll('#calc input, #calc select, #calc textarea').forEach(el=&gt;{</span></p>
<p class="p5"><span class="s1">if(el.type==='checkbox') el.checked=false; else el.value='';</span></p>
<p class="p5"><span class="s1">});</span></p>
<p class="p5"><span class="s1">document.getElementById('materialContainer').innerHTML='';</span></p>
<p class="p5"><span class="s1">addMaterialRow();</span></p>
<p class="p5"><span class="s1">localStorage.removeItem('calc');</span></p>
<p class="p5"><span class="s1">bereken();</span></p>
<p class="p5"><span class="s1">switchTab({target:{}},'calc');</span></p>
<p class="p5"><span class="s1">// optional: alert('Formulier is leeg â€“ klaar voor een nieuwe offerte!');</span></p>
<p class="p4"><span class="s3">}</span></p>
<p class="p5"><span class="s1">/* ----------<span class="Apple-converted-space">Â  </span>OFFERTE<span class="Apple-converted-space">Â  </span>---------- <i>/</i></span></p>
<p class="p5"><span class="s1"><i>function renderQuote(){</i></span></p>
<p class="p5"><span class="s1"><i>const c = STORE.calc();</i></span></p>
<p class="p5"><span class="s1"><i>if(!c.projName){ document.getElementById('quotePreview').innerHTML = '&lt;p&gt;'; return;}</i></span></p>
<p class="p5"><span class="s1"><i>/</i><span class="Apple-converted-space">Â  </span>!!<span class="Apple-converted-space">Â  </span>VUL JE ECHTE BASE-64 LOGO HIER IN<span class="Apple-converted-space">Â  </span>!!<span class="Apple-converted-space">Â  </span>*/</span></p>
<p class="p5"><span class="s1">const logoB64 = ``; // &lt;-- plak je string hier</span></p>
<p class="p4"><span class="s3">const vloerOms = (c.vlType === 'Vloerbedekking') ? 'Vloerbedekking' : </span><span class="s4">${c.vlType} vloer</span><span class="s3">;</span></p>
<p class="p11"><span class="s1"></span><br></p>
<p class="p12"><span class="s1"></span><br></p>
<p class="p13"><span class="s5">Copy</span></p>
<p class="p1"><span class="s1">let materialRowsHtml='';</span></p>
<p class="p1"><span class="s1">if(c.materialRows &amp;&amp; c.materialRows.length){</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>c.materialRows.forEach(r=&gt;{</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>const tot = (parseFloat(r.aantal)||0)*(parseFloat(r.prijs)||0);</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>materialRowsHtml+=`</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>&lt;tr&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;td&gt;${r.type} (${r.leverancier} - ${r.artNr})&lt;/td&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;td class="nr"&gt;${r.aantal} ${r.eenheid}&lt;/td&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;td class="nr"&gt;â‚¬ ${parseFloat(r.prijs).toFixed(2)}&lt;/td&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  Â  Â  </span>&lt;td class="nr"&gt;â‚¬ ${tot.toFixed(2)}&lt;/td&gt;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  Â  Â  </span>&lt;/tr&gt;`;</span></p>
<p class="p1"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>});</span></p>
<p class="p1"><span class="s1">}</span></p>
<p class="p2"><span class="s1"></span><br></p>
<p class="p1"><span class="s1">const html = `</span></p>
<p class="p3"><span class="s1"></span><br></p>
<p class="p5"><span class="s1">&lt;div class="print-header"&gt;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">Â  </span>&lt;img src="data:image/png;base64,${logoB64}" alt="Logo"&gt;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">Â  </span>&lt;div class="co-info"&gt;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>&lt;strong&gt;Next Generation Flooring&lt;/strong&gt;&lt;br&gt;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>Josephine Bakerstraat 18&lt;br&gt;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>1311 GA<span class="Apple-converted-space">Â  </span>Almere&lt;br&gt;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>Tel:<span class="Apple-converted-space">Â  </span>+31 020 210 1184&lt;br&gt;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>E-mail:<span class="Apple-converted-space">Â  </span>info@nextgenerationflooring.nl</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">Â  </span>&lt;/div&gt;</span></p>
<p class="p5"><span class="s1">&lt;/div&gt;</span></p>
<p class="p5"><span class="s1">&lt;div class="row"&gt;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">Â  </span>&lt;div class="col"&gt;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>&lt;h2&gt;Offerte ${c.projName}&lt;/h2&gt;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>&lt;table class="meta"&gt;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  </span>&lt;tr&gt;&lt;td&gt;Offertenummer:&lt;/td&gt;&lt;td&gt;NG-${c.id||'0000'}&lt;/td&gt;&lt;/tr&gt;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  </span>&lt;tr&gt;&lt;td&gt;Datum:&lt;/td&gt;&lt;td&gt;${new Date(c.date).toLocaleDateString('nl-NL')}&lt;/td&gt;&lt;/tr&gt;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  </span>&lt;tr&gt;&lt;td&gt;Klant:&lt;/td&gt;&lt;td&gt;${c.custName||''}&lt;/td&gt;&lt;/tr&gt;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  </span>&lt;tr&gt;&lt;td&gt;Projectadres:&lt;/td&gt;&lt;td&gt;${c.projAdres||''}&lt;/td&gt;&lt;/tr&gt;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  </span>&lt;tr&gt;&lt;td&gt;Geldigheid:&lt;/td&gt;&lt;td&gt;30 dagen&lt;/td&gt;&lt;/tr&gt;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>&lt;/table&gt;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">Â  </span>&lt;/div&gt;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">Â  </span>&lt;div class="col"&gt;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>&lt;img class="preview-img" src="https://source.unsplash.com/900x600/?floor,${c.vlType}" alt="${c.vlProd||'Gekozen vloer'}"&gt;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">Â  </span>&lt;/div&gt;</span></p>
<p class="p5"><span class="s1">&lt;/div&gt;</span></p>
<p class="p5"><span class="s1">&lt;div class="row"&gt;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">Â  </span>&lt;div class="col"&gt;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>&lt;h3&gt;Prijsopbouw (â‚¬ incl. 21 % BTW)&lt;/h3&gt;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>&lt;table class="details"&gt;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  </span>&lt;thead&gt;&lt;tr&gt;&lt;th&gt;Omschrijving&lt;/th&gt;&lt;th class="nr"&gt;aantal&lt;/th&gt;&lt;th class="nr"&gt;â‚¬ / eenh.&lt;/th&gt;&lt;th class="nr"&gt;bedrag&lt;/th&gt;&lt;/tr&gt;&lt;/thead&gt;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  </span>&lt;tbody&gt;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>&lt;tr&gt;&lt;td&gt;${vloerOms}&lt;/td&gt;&lt;td class="nr"&gt;${c.vlTotaal} mÂ²&lt;/td&gt;&lt;td class="nr"&gt;â‚¬ ${parseFloat(c.vlPrijs).toFixed(2)}&lt;/td&gt;&lt;td class="nr"&gt;â‚¬ ${(parseFloat(c.vlTotaal)*parseFloat(c.vlPrijs)).toFixed(2)}&lt;/td&gt;&lt;/tr&gt;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>${c.ondVereist?`</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>&lt;tr&gt;&lt;td&gt;Ondervloer ${c.ondKeuze}&lt;/td&gt;&lt;td class="nr"&gt;${c.vlOppervl} mÂ²&lt;/td&gt;&lt;td class="nr"&gt;â‚¬ ${parseFloat(c.ondPrijs).toFixed(2)}&lt;/td&gt;&lt;td class="nr"&gt;â‚¬ ${(parseFloat(c.vlOppervl)*parseFloat(c.ondPrijs)).toFixed(2)}&lt;/td&gt;&lt;/tr&gt;`:''}</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>&lt;tr&gt;&lt;td&gt;Plinten ${c.plintKeuze}&lt;/td&gt;&lt;td class="nr"&gt;${c.omtrek} m&lt;/td&gt;&lt;td class="nr"&gt;â‚¬ ${parseFloat(c.plintPrijs).toFixed(2)}&lt;/td&gt;&lt;td class="nr"&gt;â‚¬ ${(parseFloat(c.omtrek)*parseFloat(c.plintPrijs)).toFixed(2)}&lt;/td&gt;&lt;/tr&gt;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  Â  </span>${materialRowsHtml}</span></p>
<p class="p4"><span class="s3"><span class="Apple-converted-space">Â  Â  Â  Â  </span>&lt;tr&gt;&lt;td&gt;Arbeid &amp; service&lt;/td&gt;&lt;td class</span></p>
<p class="p7"><span class="s1"></span><br></p>
<p class="p8"><span class="s3">Copy</span></p>
<p class="p7"><span class="s1"></span><br></p>
<p class="p8"><span class="s3">Share</span></p>
<p class="p9"><span class="s1"></span><br></p>
<p class="p7"><span class="s1"></span><br></p>
<p class="p7"><span class="s1"></span><br></p>
<p class="p3"><span class="s1"></span><br></p>
<p class="p5"><span class="s1">="nr"&gt;&lt;td class="nr"&gt;&lt;td class="nr"&gt;</span></p>
<p class="p6"><span class="s1"></span><br></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">Â  </span>&lt;/div&gt;</span></p>
<p class="p5"><span class="s1">&lt;/div&gt;</span></p>
<p class="p5"><span class="s1">&lt;div class="row"&gt;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">Â  </span>&lt;div class="col"&gt;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>&lt;h3&gt;Levering &amp; garantie&lt;/h3&gt;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>&lt;ul&gt;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  </span>&lt;li&gt;Levertijd: 5-10 werkdagen na akkoord&lt;/li&gt;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  </span>&lt;li&gt;10 jaar woon-garantie op de vloer&lt;/li&gt;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  </span>&lt;li&gt;2 jaar garantie op gehele installatie&lt;/li&gt;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">Â  Â  Â  </span>&lt;li&gt;Professionele legservice inbegrepen&lt;/li&gt;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>&lt;/ul&gt;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>&lt;p&gt;&lt;strong&gt;Opmerkingen:&lt;/strong&gt; ${c.vrijTekst||'Geen bijzonderheden.'}&lt;/p&gt;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">Â  </span>&lt;/div&gt;</span></p>
<p class="p5"><span class="s1">&lt;/div&gt;</span></p>
<p class="p5"><span class="s1">&lt;div class="row"&gt;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">Â  </span>&lt;div class="col"&gt;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>&lt;button class="btn success" onclick="alert('Bedankt â€“ u ontvangt binnen 1 uur een bevestiging per e-mail!')"&gt;Offerte digitaal ondertekenen&lt;/button&gt;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>&lt;button class="btn secondary" onclick="window.print()"&gt;Download / print PDF&lt;/button&gt;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">Â  </span>&lt;/div&gt;</span></p>
<p class="p5"><span class="s1">&lt;/div&gt;`;</span></p>
<p class="p5"><span class="s1"><span class="Apple-converted-space">Â  Â  </span>document.getElementById('quotePreview').innerHTML = html;</span></p>
<p class="p4"><span class="s3">}</span></p>
<p class="p5"><span class="s1">/* ----------<span class="Apple-converted-space">Â  </span>MGMT<span class="Apple-converted-space">Â  </span>---------- <i>/</i></span></p>
<p class="p5"><span class="s1"><i>function renderMgmt(){</i></span></p>
<p class="p5"><span class="s1"><i>const list = STORE.offertes();</i></span></p>
<p class="p5"><span class="s1"><i>const won = list.filter(o=&gt;o.status==='Gewonnen');</i></span></p>
<p class="p5"><span class="s1"><i>const verzonden = list.filter(o=&gt;['Verzonden','Aangepast','Gewonnen','Verloren'].includes(o.status));</i></span></p>
<p class="p5"><span class="s1"><i>const aov = won.length ? won.reduce((s,o)=&gt;s+parseFloat(o.totBruto),0)/won.length : 0;</i></span></p>
<p class="p5"><span class="s1"><i>const conv = verzonden.length ? (100</i>won.length/verzonden.length) : 0;</span></p>
<p class="p5"><span class="s1">const pipe = list.filter(o=&gt;['Concept','Verzonden','Aangepast'].includes(o.status))</span></p>
<p class="p5"><span class="s1">.reduce((s,o)=&gt;s+parseFloat(o.totBruto),0);</span></p>
<p class="p5"><span class="s1">document.querySelector('#kpiAOV span').innerText = aov.toFixed(0);</span></p>
<p class="p5"><span class="s1">document.querySelector('#kpiConv span').innerText = conv.toFixed(1);</span></p>
<p class="p5"><span class="s1">document.querySelector('#kpiPipe span').innerText = pipe.toFixed(0);</span></p>
<p class="p5"><span class="s1">drawBar('pipeChart',{labels:['Concept','Verzonden','Aangepast','Gewonnen','Verloren'],</span></p>
<p class="p5"><span class="s1">data:[list.filter(o=&gt;o.status==='Concept').length,</span></p>
<p class="p5"><span class="s1">list.filter(o=&gt;o.status==='Verzonden').length,</span></p>
<p class="p5"><span class="s1">list.filter(o=&gt;o.status==='Aangepast').length,</span></p>
<p class="p5"><span class="s1">won.length,</span></p>
<p class="p5"><span class="s1">list.filter(o=&gt;o.status==='Verloren').length]});</span></p>
<p class="p5"><span class="s1">drawPie('lossChart',['Prijs te hoog','Levertermijn','Product niet beschikbaar','Andere'],[40,25,20,15]);</span></p>
<p class="p5"><span class="s1">const omzetPerType = {};</span></p>
<p class="p5"><span class="s1">list.forEach(o=&gt;{ if(o.status==='Gewonnen') omzetPerType[o.vlType] = (omzetPerType[o.vlType]||0) + parseFloat(o.totBruto);});</span></p>
<p class="p5"><span class="s1">drawBar('prodChart',{labels:Object.keys(omzetPerType),data:Object.values(omzetPerType)});</span></p>
<p class="p4"><span class="s3">}</span></p>
<p class="p5"><span class="s1">/* ----------<span class="Apple-converted-space">Â  </span>CHARTS<span class="Apple-converted-space">Â  </span>---------- <i>/</i></span></p>
<p class="p5"><span class="s1"><i>function drawBar(canvasId,{labels,data}){</i></span></p>
<p class="p5"><span class="s1"><i>const canv = document.getElementById(canvasId);</i></span></p>
<p class="p5"><span class="s1"><i>const ctx = canv.getContext('2d');</i></span></p>
<p class="p5"><span class="s1"><i>const pad = 30; const w = canv.width = canv.offsetWidth; const h = 160;</i></span></p>
<p class="p5"><span class="s1"><i>const barW = (w-2</i>pad)/labels.length;</span></p>
<p class="p5"><span class="s1">const max = Math.max(...data,1);</span></p>
<p class="p5"><span class="s1">ctx.clearRect(0,0,w,h);</span></p>
<p class="p5"><span class="s1">labels.forEach((l,i)=&gt;{</span></p>
<p class="p5"><span class="s1">const hei = (data[i]/max)<i>(h-2</i>pad);</span></p>
<p class="p5"><span class="s1">ctx.fillStyle='#0d47a1'; ctx.fillRect(pad+i<i>barW+8,h-pad-hei,barW-16,hei);</i></span></p>
<p class="p5"><span class="s1"><i>ctx.fillStyle='#000'; ctx.font='12px sans-serif'; ctx.textAlign='center';</i></span></p>
<p class="p5"><span class="s1"><i>ctx.fillText(l,pad+i</i>barW+barW/2,h-10);</span></p>
<p class="p5"><span class="s1">ctx.fillText(data[i],pad+i<i>barW+barW/2,h-pad-hei-5);</i></span></p>
<p class="p5"><span class="s1"><i>});</i></span></p>
<p class="p5"><span class="s1"><i>}</i></span></p>
<p class="p5"><span class="s1"><i>function drawPie(canvasId,labels,data){</i></span></p>
<p class="p5"><span class="s1"><i>const canv = document.getElementById(canvasId);</i></span></p>
<p class="p5"><span class="s1"><i>const ctx = canv.getContext('2d');</i></span></p>
<p class="p5"><span class="s1"><i>const w = canv.width = canv.offsetWidth; const h = 160; const R = Math.min(w,h)/2-20;</i></span></p>
<p class="p5"><span class="s1"><i>const tot = data.reduce((a,b)=&gt;a+b,0);</i></span></p>
<p class="p5"><span class="s1"><i>let cur = 0;</i></span></p>
<p class="p5"><span class="s1"><i>const colors = ['#c62828','#ff6f00','#2e7d32','#0277bd'];</i></span></p>
<p class="p5"><span class="s1"><i>ctx.clearRect(0,0,w,h);</i></span></p>
<p class="p5"><span class="s1"><i>data.forEach((v,i)=&gt;{</i></span></p>
<p class="p5"><span class="s1"><i>const ang = v/tot</i>2*Math.PI;</span></p>
<p class="p5"><span class="s1">ctx.beginPath(); ctx.moveTo(w/2,h/2);</span></p>
<p class="p5"><span class="s1">ctx.arc(w/2,h/2,R,cur,cur+ang);</span></p>
<p class="p5"><span class="s1">ctx.closePath(); ctx.fillStyle=colors[i%colors.length]; ctx.fill();</span></p>
<p class="p5"><span class="s1">cur+=ang;</span></p>
<p class="p5"><span class="s1">});</span></p>
<p class="p4"><span class="s3">}</span></p>
<p class="p5"><span class="s1">/* ----------<span class="Apple-converted-space">Â  </span>START<span class="Apple-converted-space">Â  </span>---------- */</span></p>
<p class="p5"><span class="s1">(function(){</span></p>
<p class="p5"><span class="s1">addMaterialRow(); // 1 lege regel</span></p>
<p class="p5"><span class="s1">const c = STORE.calc();</span></p>
<p class="p5"><span class="s1">if(c.projName){</span></p>
<p class="p5"><span class="s1">if(c.materialRows &amp;&amp; c.materialRows.length){</span></p>
<p class="p5"><span class="s1">document.getElementById('materialContainer').innerHTML='';</span></p>
<p class="p5"><span class="s1">c.materialRows.forEach(r=&gt;addMaterialRow(r));</span></p>
<p class="p5"><span class="s1">}</span></p>
<p class="p5"><span class="s1">Object.keys(c).forEach(k =&gt; {</span></p>
<p class="p5"><span class="s1">const el = document.getElementById(k);</span></p>
<p class="p5"><span class="s1">if(el &amp;&amp; el.tagName !== 'TABLE') el.value = c[k];</span></p>
<p class="p5"><span class="s1">});</span></p>
<p class="p5"><span class="s1">bereken();</span></p>
<p class="p5"><span class="s1">}</span></p>
<p class="p5"><span class="s1">if(!STORE.offertes().length) resetData();</span></p>
<p class="p5"><span class="s1">})();</span></p>
<p class="p5"><span class="s1">&lt;/body&gt;</span></p>
<p class="p4"><span class="s3">&lt;/html&gt;</span></p>
</body>
</html>
